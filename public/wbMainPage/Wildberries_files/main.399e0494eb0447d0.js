!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="52c60ebc-21d1-414d-90cc-2926409c3077",e._sentryDebugIdIdentifier="sentry-dbid-52c60ebc-21d1-414d-90cc-2926409c3077")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"root-monorepo@v1.25.0"},(self.webpackChunk=self.webpackChunk||[]).push([[179],{77552:(e,t,r)=>{"use strict";r(73637);var n=r(2784),i=r.t(n,2),o=r(30813),a=r(57915),s=r(17029),c=r(99842),l=r(81),d=r(168),u=r(71606),p=r(45541),E=r(42335),h=r(9178);var m=r(28316),g=r.t(m,2),_=r(88702),y=r(91199),S=r(81141),w=r(93014),v=r(72903),T=r.n(v),A=r(4108),f=r(50069),R=r(82763),C=r(14643),N=r(57228),b=r(49356),I=r(14479),L=r(51085),P=r(39706),D=r(12333),x=r(60202),O=r(24059),k=r(72779),U=r(66582),F=r(87391),M=r(79268);const q={react:i,"react-dom":g,"react-redux":_,"redux-saga":y,redux:w,reselect:S,"react-router5":u,"router5-helpers":f,"router5-plugin-browser":R,"router5-plugin-logger":C,router5:A,"react-device-detect":U,"@wildberries/service-router":a,"@portals/service-router":a,"@wildberries/service-products":d,"@portals/service-products":d,"@wildberries/service-user":p,"@portals/service-user":p,"@wildberries/i18next-utils":l,"@portals/i18next-utils":l,"@portals/geo-utils":N,"@wildberries/service-pwa":b,"@portals/service-pwa":b,i18next:c,"@mihanizm56/redux-core-modules":o,"@portals/redux-core-modules":o,"@ravilm/databus":I,"@portals/databus":I,"@ravilm/databus-react":L,"@portals/databus-react":L,"@hapi/joi":v,joi:v,"@wildberries/databus-service-products":P,"@portals/databus-service-products":P,"@wildberries/databus-service-user":D,"@portals/databus-service-user":D,"@mihanizm56/fetch-api":h,"@portals/fetch-api":h,"@wildberries/wb-front-performance-tracker":x,"@portals/wb-front-performance-tracker":x,"@wildberries/wb-front-analytics-tracker":O,"@portals/wb-front-analytics-tracker":O,"@wildberries/service-logger":E,"@portals/service-logger":E,classnames:k,"react-virtualized":F,"@portals/quiz-front":M,"@portals/quiz-trigger":M},B=(e,t)=>e[t]||q[t],j=new Map,$=({name:e,staticURL:t,jsUrl:r,fromCDN:n,cdnData:{APP_STATIC_NAMESPACE:i}={},version:o="",externalPackages:a={}})=>{const s=n?r:`${t}/${r}`;let c;return j.has(s)?c=j.get(s):(c=new Promise((async(e,r)=>{try{const{data:r,error:c,errorText:l}=await(async(e,t)=>(new h.PureRestRequest).getRequest({mode:"cors",parseType:"text",endpoint:e,extraValidationCallback:()=>!0,isErrorTextStraightToOutput:!0,pureJsonFileResponse:t,retry:2,cache:t?"force-cache":"default"}))(s,n);if(c)throw new Error(l);const d=r.replace(/pathToReplaceRuntimeEnvs/g,`/nsf/ui/${i}/umd/`).replace(/appVersion/g,o).replace(/publicPathForReplace/g,`${t}/umd/`),u=new Function("exports","require","module",d),p={exports:{}};u(p.exports,B.bind(null,a),p),e(p.exports)}catch(c){console.error("fetching the route script ended with an error",c),r(c)}})),j.set(s,c)),c.then((t=>{if(t)return t;console.error(`"${e}" was not created by "${s}"`),j.delete(s)})).catch((()=>{j.delete(s)}))};var G=r(73746),V=r(23443);const W="@platform/platform-modules",K="@platform-modules/FETCH_PLATFORM_MODULES_SAGA",H=()=>({type:K}),z="@platform-modules/SET_PLATFORM_MODULES_DATA",J="@platform-modules/SET_LOADING_START",X="@platform-modules/SET_LOADING_STOP",Y={loading:!1,modules:[]},Q=e=>e[W]||Y,Z=(0,S.createSelector)(Q,(({modules:e})=>e)),ee=(0,S.createSelector)(Q,(({loading:e})=>e));var te=r(20608);function*re({router:e,store:t}){yield(0,te.gz)({type:J});try{const i=[{name:"Header",role:"component",loadRef:{importFn:()=>Promise.all([r.e(410),r.e(676),r.e(317),r.e(274),r.e(592),r.e(280),r.e(933)]).then(r.bind(r,88933)),JS_CDN:null,JS:null,CSS_CDN:null,CSS:null,APP_STATIC_NAMESPACE:null}},{name:"Layout",role:"component",loadRef:{importFn:()=>Promise.all([r.e(410),r.e(676),r.e(317),r.e(379),r.e(592),r.e(903),r.e(473)]).then(r.bind(r,15152)),JS_CDN:null,JS:null,CSS_CDN:null,CSS:null,APP_STATIC_NAMESPACE:null}},{name:"Content",role:"component",loadRef:{importFn:()=>Promise.all([r.e(700),r.e(592),r.e(343)]).then(r.bind(r,88343)),JS_CDN:null,JS:null,CSS_CDN:null,CSS:null,APP_STATIC_NAMESPACE:null}},{name:"Footer",role:"component",loadRef:{importFn:()=>Promise.all([r.e(410),r.e(274),r.e(592),r.e(696)]).then(r.bind(r,96696)),JS_CDN:null,JS:null,CSS_CDN:null,CSS:null,APP_STATIC_NAMESPACE:null}},{name:"ErrorPage",role:"component",loadRef:{importFn:()=>r.e(181).then(r.bind(r,11181)),JS_CDN:null,JS:null,CSS_CDN:null,CSS:null,APP_STATIC_NAMESPACE:null}},{name:"Preview",role:"component",loadRef:{importFn:()=>Promise.all([r.e(700),r.e(592),r.e(619)]).then(r.bind(r,37619)),JS_CDN:null,JS:null,CSS_CDN:null,CSS:null,APP_STATIC_NAMESPACE:null}},{name:"page-not-found",role:"not-component",loadRef:{importFn:()=>r.e(434).then(r.bind(r,94434)),JS_CDN:null,JS:null,CSS_CDN:null,CSS:null,APP_STATIC_NAMESPACE:null}}],o={};yield Promise.all(i.map((async({name:r,loadRef:n,role:i})=>{try{if("component"===i){const{Component:i,registrationSaga:a,registrationReducer:s,registrationActions:c,registrationRouterMiddlewares:l,registrationRouterPlugins:d}=await n.importFn();a&&a({store:t}),s&&s({store:t}),c&&c.forEach((r=>{r({store:t,router:e})})),l&&l.forEach((t=>e.useMiddleware(t))),d&&d.forEach((t=>e.usePlugin(t))),o[r]=i}else{const{routes:t}=await n.importFn(),{loadAction:r}=t[0]||{},{routes:i}=e.getDependencies();e.setDependencies({routes:[...i,...t]}),e.add(t),r&&await r()}}catch(a){console.error(`Load platform module "${r}" get an error`,a)}}))),yield(0,te.gz)((n={modules:o},{type:z,payload:n}))}catch(i){console.error("fetchPlatformModulesWatcherSaga get an error",i.message)}finally{yield(0,te.gz)({type:X})}var n}const ne="FETCH_PLATFORM_MODULES_WATCHER_SAGA_NAME";const ie="@platform/app-state",oe="@app-state/SET_TRANSLATE_LOADING_START",ae="@app-state/SET_TRANSLATE_LOADING_STOP",se="@app-state/SET_INIT_LOADING_START",ce="@app-state/SET_INIT_LOADING_STOP",le=()=>({type:ce}),de="@app-state/SET_LOGIN_LOADING_START",ue="@app-state/LOGOUT",pe=()=>({type:ue}),Ee="@app-state/SET_CORE_REQUESTS_ERROR",he=()=>({type:Ee}),me="@app-state/RESET_CORE_REQUESTS_ERROR",ge=()=>({type:me}),_e=()=>({type:"@app-state/RESET_CORE_REQUESTS_HEALTHCHECK_INTERVAL"}),ye="@app-state/SET_HEALTHCHECK_ACTION",Se="@app-state/INCREMENT_HEALTHCHECK_ACTION",we=()=>({type:Se}),ve="@app-state/RESET_HEALTHCHECK_ACTION",Te=()=>({type:ve}),Ae="@app-state/SET_CORE_REQUESTS_ERROR_CODE",fe="@app-state/RESET_CORE_REQUESTS_ERROR_CODE",Re="@app-state/SET_FIRST_ROUTE_TRANSITION_FINISHED",Ce="@app-state/SET_LOGOUT_LOADING_START",Ne="@app-state/SET_LOGOUT_LOADING_STOP",be={initLoading:!1,translateIsLoading:!1,loginLoading:!1,coreRequestsError:!1,healthCheckCoreRequestsInterval:1e4,coreRequestsErrorCode:"",firstRouteTransitionFinished:!1,logoutLoading:!1},Ie=e=>e[ie]||be,Le=(0,S.createSelector)(Ie,(({translateIsLoading:e})=>e)),Pe=(0,S.createSelector)(Ie,(({initLoading:e})=>e)),De=(0,S.createSelector)(Ie,(({loginLoading:e})=>e)),xe=(0,S.createSelector)(Ie,(({coreRequestsError:e})=>e)),Oe=(0,S.createSelector)(Ie,(({coreRequestsErrorCode:e})=>e)),ke=(0,S.createSelector)(Ie,(({healthCheckCoreRequestsInterval:e})=>e)),Ue=(0,S.createSelector)(Ie,(({firstRouteTransitionFinished:e})=>e)),Fe=(0,S.createSelector)(Ie,(({logoutLoading:e})=>e)),Me={en:["ru"],zh:["en","ru"],"en-rtl":["en","ru"],ka:["en"],tr:["en","ru"],be:["ru"]},qe={be:"ru"},Be=({formattedResponseData:{code:e,error:t}})=>!!t&&401!==e,je="abac-permissions-data-cache-key",$e="root",Ge="root",Ve={Firefox:"Mozilla Firefox",YaBrowser:"Yandex Browser",OPR:"Opera",Trident:"Internet Explorer",Edge:"Microsoft Edge",Chrome:"Google Chrome",Safari:"Safari"},We=[{device:"Android",platform:/Android/},{device:"iPhone",platform:/iPhone/},{device:"iPad",platform:/iPad/},{device:"Symbian",platform:/Symbian/},{device:"Windows Phone",platform:/Windows Phone/},{device:"Tablet OS",platform:/Tablet OS/},{device:"Linux",platform:/Linux/},{device:"Windows",platform:/Windows NT/},{device:"Macintosh",platform:/Macintosh/}],Ke={storageCacheName:"root__v1.25.0__requests-cache",expires:5184e6,debug:!0,disabledCache:"true"===window.ENVS.DISABLED_API_CACHE},He="wb-eu-passport-v2.access-token",ze="wb-eu-portal.downgrade-list",Je="wb-eu-portal.last_successful_login",Xe="fromSellerLanding",Ye={incorrectCode:`${$e}:critical-confirm-modal.incorrectCode`,requestError:`${$e}:critical-confirm-modal.requestError`,abortEnterCodeError:`${$e}:critical-confirm-modal.abortEnterCodeError`,reachedLimit:`${$e}:critical-confirm-modal.reachedLimit`};let Qe=!1;class LocalStorageWorker{}LocalStorageWorker.setItem=(e,t)=>{try{if("string"==typeof t)return localStorage.setItem(e,t);localStorage.setItem(e,JSON.stringify(t))}catch(r){console.error("failed setItem to local storage",r)}},LocalStorageWorker.getItem=e=>{const t=localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(r){return null}return t},LocalStorageWorker.deleteItem=e=>{try{localStorage.removeItem(e)}catch(t){console.error("error in deleteItem",t)}};const Ze=e=>{var t;const r=encodeURIComponent(window.location.href),n=window.__ENDPOINTS__?window.__ENDPOINTS__.LOGIN_PAGE_ENDPOINT:"/login/";(0,l.setLocale)({locale:"",isFromCookie:!0});const i=e?`${e}/`:e;if((()=>{const e=!!LocalStorageWorker.getItem(Je);return"/"===window.location.pathname&&window.ENVS.ENABLE_PORTAL_LANDING&&!e&&!Qe})()&&null!=(t=window.__ENDPOINTS__)&&t.PORTAL_LANDING)return void(window.location.href=(0,N.resolveUrl)(`${window.__ENDPOINTS__.PORTAL_LANDING}/${i}?redirect_url=${r}`));const o=Qe?`&${Xe}`:"";window.location.href=(0,N.resolveUrl)(`${n}/${i}?redirect_url=${r}${o}`)},et=()=>{LocalStorageWorker.deleteItem(`${Ge}.id`),LocalStorageWorker.deleteItem(He)};var tt,rt,nt,it,ot,at,st,ct,lt,dt,ut,pt,Et,ht,mt,gt;const _t="/passport",yt=null!=(tt=null==(rt=window)||null==(rt=rt.__ENDPOINTS__)?void 0:rt.CENTRAL_PASSPORT)?tt:"/login",St=null!=(nt=null==(it=window)||null==(it=it.__ENDPOINTS__)?void 0:it.LOGIN_PAGE_ENDPOINT)?nt:"/login",wt="/upgrade-cookie-authv3",vt="/downgrade-cookie-authv3",Tt=`${_t}/api/v2/auth/grant`,At=`${yt}/api/v2/auth/grant`,ft=`${_t}/api/v2/auth/login`,Rt=`${yt}/api/v2/auth/login`,Ct=`${_t}/api/v2/auth/introspect`,Nt=`${_t}/api/v2/auth/wild_v3_upgrade`,bt=`${_t}/api/v2/auth/logout`,It=`${yt}/api/v2/auth/logout`,Lt=`${St}${_t}/api/v2/auth/logout`,Pt=null==(ot=window)||null==(ot=ot.__ENDPOINTS__)?void 0:ot.CMP_ENDPOINT,Dt=Pt?`${Pt}${_t}/api/v2/auth/logout`:"",xt=null==(at=window)||null==(at=at.__ENDPOINTS__)?void 0:at.CMP_NEW_ENDPOINT,Ot=xt?`${xt}${_t}/api/v2/auth/logout`:"",kt=null==(st=window)||null==(st=st.__ENDPOINTS__)?void 0:st.DELIVERY_OPTIONS_ENDPOINT,Ut=kt?`${kt}${_t}/api/v2/auth/logout`:"",Ft=null!=(ct=null==(lt=window)||null==(lt=lt.__ENDPOINTS__)?void 0:lt.UPGRADE_COOKIE_ENDPOINT)?ct:wt,Mt=null!=(dt=null==(ut=window)||null==(ut=ut.__ENDPOINTS__)?void 0:ut.DOWNGRADE_COOKIE_ENDPOINT)?dt:vt,qt=null!=(pt=null==(Et=window)||null==(Et=Et.__ENDPOINTS__)?void 0:Et.AUTH_V3_BASE)?pt:"/auth",Bt=`${qt}/v2/auth/logoff`,jt=`${qt}/v2/auth/slide-v3`,$t=`${qt}/v2/auth/slide-v3-confirm`,Gt=`${qt}/api/set-pub-key`,Vt=null==(ht=window)||null==(ht=ht.__ENDPOINTS__)?void 0:ht.MFA_GET_STATE_ENDPOINT,Wt=`${Vt}/api/v1/MFA/request`,Kt=`${Vt}/api/v1/MFA/validate`,Ht=null!=(mt=null==(gt=window)||null==(gt=gt.__ENDPOINTS__)?void 0:gt.LOGOUT_NAPI)?mt:"/empty_napi",zt=()=>(new h.PureRestRequest).getRequest({credentials:"include",endpoint:Ht,isErrorTextStraightToOutput:!0,retry:2,extraVerifyRetry:Be,tracingDisabled:!0,middlewaresAreDisabled:!0}),Jt={"wb-apptype":"web","wb-appversion":"v1.25.0","app-name":"seller.root"},Xt=T().object({result:T().number().required(),error:T().any().when("result",{not:T().valid(0),then:T().string().required(),otherwise:T().forbidden()})}),Yt=()=>(new h.PureRestRequest).postRequest({endpoint:Bt,responseSchema:Xt,credentials:"include",headers:Object.assign({},Jt)});class RefreshTokenCookieUnavailable extends Error{}var Qt=r(39925),Zt=r.n(Qt),er=r(30195);const tr=e=>(new h.PureRestRequest).postRequest((e=>({endpoint:Gt,method:"POST",credentials:"include",headers:{"Access-Token":e.accessToken},body:{payment_pub_key:e.pubKey}}))(e));class SodiumKeyPair{static async fromLocalStorage(e){try{await Zt().ready;const t=localStorage.getItem(this.LOCAL_STORAGE_KEY_NAME),r=t?new this(this.Schema.parse(JSON.parse(t)),e):null;return await(null==r?void 0:r.testSign()),r}catch(t){return null}}static async generate(e){await Zt().ready;const t=Zt().crypto_sign_keypair("uint8array"),r=new this({keyType:t.keyType,privateKey:Zt().to_base64(t.privateKey,Zt().base64_variants.ORIGINAL),publicKey:Zt().to_base64(t.publicKey,Zt().base64_variants.ORIGINAL)},e);return await r.testSign(),r}constructor(e,t){this.getSignData=t,this.keyType=void 0,this.privateKey=void 0,this.publicKey=void 0,this.keyType=e.keyType,this.privateKey=e.privateKey,this.publicKey=e.publicKey}async testSign(){const e=String(Math.random()),t=await this.sign((()=>e)),r=Zt().from_base64(t,Zt().base64_variants.ORIGINAL),n=Zt().from_base64(this.publicKey,Zt().base64_variants.ORIGINAL);if(Zt().crypto_sign_open(r,n,"text")!==e)throw new Error("Invalid key pair!")}clear(){localStorage.removeItem(SodiumKeyPair.LOCAL_STORAGE_KEY_NAME)}saveToLocalStorage(){localStorage.setItem(SodiumKeyPair.LOCAL_STORAGE_KEY_NAME,JSON.stringify(this))}async sign(e){await Zt().ready;const t=e(await this.getSignData()),r=Zt().from_base64(this.privateKey,Zt().base64_variants.ORIGINAL),n=Zt().crypto_sign(t,r,"uint8array");return Zt().to_base64(n,Zt().base64_variants.ORIGINAL)}async savePublicKeyToBucket(e){try{await Zt().ready;const t=await tr({pubKey:Zt().to_hex(Zt().from_base64(this.publicKey,Zt().base64_variants.ORIGINAL)),accessToken:e});if(t.error)throw t}catch(t){throw console.error("Public key save to bucket fail:",t),t}}async save(e){await this.savePublicKeyToBucket(e),this.saveToLocalStorage()}}SodiumKeyPair.LOCAL_STORAGE_KEY_NAME="wb-portal.transaction-signature-keys",SodiumKeyPair.Schema=er.z.object({keyType:er.z.enum(["curve25519","ed25519","x25519"]),privateKey:er.z.string().base64(),publicKey:er.z.string().base64()});const rr=e=>(new h.PureRestRequest).postRequest((({endpoint:e="",isCurrentDomainEndpoint:t=!0,middlewaresAreDisabled:r})=>({endpoint:t?Mt:`${e}${vt}`,credentials:"include",middlewaresAreDisabled:r,responseSchema:T().object({success:T().string().required()})}))(e)),nr=()=>{try{return localStorage.getItem(ze)}catch(e){return[]}},ir=e=>{try{const t=Array.isArray(e)?e:JSON.parse(e);return Array.isArray(t)?t.map(String):[]}catch(t){}return[]},or=/(\/external-api-[^/]+)\//,ar=new RegExp(`${N.currentZone.replaceAll(".","\\.")}$`),sr=e=>{const{origin:t,pathname:r}=(e=>{try{const{origin:t,pathname:r}=new URL(e);return{origin:t,pathname:r}}catch(t){return{origin:"",pathname:e}}})(e),n=or.exec(r);if(t&&!ar.test(t))return"";if(n){const[,e]=n;return t+e}return t},cr=e=>{try{const t=ir(nr()),r=ir(e);return[...t,...r].map(sr).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[])}catch(t){return[]}},lr=e=>{if(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(window.atob(t).split("").map((e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`)).join(""));return JSON.parse(r)}return""};var dr=r(6364),ur=r(18106);const pr="deviceIdForCritActionLimited",Er=()=>{const e=localStorage.getItem(pr);if(e)return e;const t=(0,dr.Z)(),r=`crit_${(0,ur.selectedSupplierIdSelector)()}_${t}`.substring(0,64);return localStorage.setItem(pr,r),r},hr=()=>{const e=localStorage.getItem(He);if(!e)throw new ReferenceError("Access token not defined!");const t=lr(e);if(!t)throw new TypeError("Invalid access token!");return{userId:t.user,sessionId:t.session_id,userShardId:t.shard_key,deviceId:Er()}},mr=async()=>{var e;if(!window.ENVS.ENABLE_AUTH_V3)throw new RefreshTokenCookieUnavailable;const{data:{result:t,error:r}}=await Yt();if(null==(e=await SodiumKeyPair.fromLocalStorage(hr))||e.clear(),await(async()=>{const e=cr(window.LOGOUT_REQUIRED_EXTERNAL_ORIGINS).map((e=>rr({endpoint:e,isCurrentDomainEndpoint:!1}))),t=rr({isCurrentDomainEndpoint:!0});return await Promise.allSettled([...e,t]),!0})(),0!==t)throw new RefreshTokenCookieUnavailable;return!0},gr=()=>{const e=(()=>{const e=cr(window.LOGOUT_REQUIRED_EXTERNAL_ORIGINS).map((e=>(e=>`${e}/passport/api/v2/auth/logout`)(e)));return[...[bt,Lt,Dt,Ot,Ut,It].filter((e=>!!e)),...e]})();return Promise.allSettled([...e.map((e=>(e=>(new h.PureRestRequest).postRequest({headers:{"Content-Type":"application/json"},body:{},credentials:"include",endpoint:e,isErrorTextStraightToOutput:!0,retry:2,extraVerifyRetry:Be,tracingDisabled:!0,extraValidationCallback:({statusCode:e})=>200===e,middlewaresAreDisabled:!0}))(e))),zt])};function*_r(){try{yield(0,te.gz)({type:Ce});try{yield(0,te.$6)([(0,te.RE)(mr),(0,te.RE)(gr)])}catch(e){if(!(e instanceof RefreshTokenCookieUnavailable))throw e}(()=>{try{localStorage.removeItem(ze)}catch(e){}})()}catch(t){console.error("logoutWorkerSaga get an error",t.message)}finally{const e=(0,l.getLocale)({isFromCookie:!0,supportedLocales:window.LANGUAGES_FALLBACK,localesMap:qe});et(),(0,V.r1)(),Ze(e),yield(0,te.gz)({type:Ne})}}const yr="LOGOUT_ROOT_SAGA_NAME";const Sr=({cacheKey:e,strategy:t})=>Object.assign({},Ke,{strategy:t||"NetworkFirst",requestCacheKey:e}),wr=({cacheKey:e,strategy:t,userId:r,menuFromFileRequest:n,defaultShown:i})=>{const{ENVS:{MAIN_ABAC_SCOPE:o},__ENDPOINTS__:{LOAD_MENU_REQUEST_ENDPOINT:a,LOAD_MENU_FILE_REQUEST_ENDPOINT:s}}=window;return(a||s)&&o?{defaultShown:i,menuFromFileRequest:n,loadMenuRequestEndpoint:n?s:a,appNamespace:o,browserCacheParams:e&&r?Sr({cacheKey:n?`get-menu-file-request-${e}-${r}`:`get-menu-request-${e}-${r}`,strategy:t||"NetworkFirst"}):null}:{loadMenuRequestEndpoint:"",appNamespace:"",menuFromFileRequest:!1}},vr=e=>{const t={};return document.cookie.split(";").forEach((e=>{const[r,n]=e.split("=");t[r.trim()]=n.trim()})),t[e]},Tr=({getCookie:e})=>{const t=window.FETCH_MENU_CACHE_KEY_FUNCTION;if(t)try{const r=new Function(`return ${t}`)();return Object.assign({},r({getCookie:e}))}catch(r){return console.error("error in getFetchMenuCacheKey function",r),E.sentryLogger.sendError({error:r,project:Ge,message:"error in getFetchMenuCacheKey function"}),{key:""}}return{key:""}},Ar="abac",fr="toggleNgABAC",Rr=[{scope:D.AB_EXPERIMENTS_SCOPE,featureKey:D.AB_EXPERIMENTS_ABAC_FEATURE},{scope:Ar,featureKey:fr}],Cr=e=>Rr.map((t=>Object.assign({},t,{key:e})));function*Nr({dispatch:e}){for(;;)try{var t;const{id:r}=yield(0,te.Ys)(p.getUserInfo),n=yield(0,te.Ys)(p.getUserAllPermissions),i=null==n||null==(t=n[Ar])?void 0:t[fr],o=yield(0,te.Ys)(ke);yield(0,te.gw)(o),yield(0,te.gz)((0,p.fetchUserPermissionsAction)({customPermissionsRequestParams:{scope:window.ENVS.MAIN_ABAC_SCOPE,key:null,noRetry:!0,isNgABACEnabled:i},isNgABACEnabled:i,scope:window.ENVS.MAIN_ABAC_SCOPE,withoutErrorNotification:!0,withoutLoadingIndicator:!0,successCallbackFinallyLoad:({loadingStopAction:t})=>{const n=Tr({getCookie:vr}).key;e(t()),e((0,d.fetchMenuActionSaga)({withoutLoadingIndicator:!0,successActionsArray:[ge,Te,_e],errorAction:we,noRetry:!0,configs:wr({cacheKey:n,userId:r,menuFromFileRequest:!0,defaultShown:!0})}))},errorAction:we}))}catch(r){console.error("error in healthCheckWorkerSaga",r)}}const br="HEALTH_CHECK_SAGA_NAME";var Ir=r(2183),Lr=r.n(Ir);var Pr=r(52322);const Dr=Lr().bind({Text:"text_Text__BSMLK","Text--h0":"text_Text--h0__9DJjg","Text--h1":"text_Text--h1__OxNi2","Text--h2":"text_Text--h2__logMi","Text--h3":"text_Text--h3__WJkha","Text--h3-bold":"text_Text--h3-bold__mvyKy","Text--h4":"text_Text--h4__JrhVz","Text--h4-bold":"text_Text--h4-bold__ryjCa","Text--h5":"text_Text--h5__yJ1Xq","Text--h5-bold":"text_Text--h5-bold__5eN0d","Text--orange":"text_Text--orange__RyFFC","Text--darkPurple":"text_Text--darkPurple__zq9ib","Text--purple":"text_Text--purple__6Wn+Q","Text--lightPurple":"text_Text--lightPurple__Xxml8","Text--superDuperLightPurple":"text_Text--superDuperLightPurple__8VwjW","Text--superDuperLightGrey":"text_Text--superDuperLightGrey__JJSgt","Text--red":"text_Text--red__KhmSJ","Text--blue":"text_Text--blue__MURAz","Text--pink":"text_Text--pink__eQmuS","Text--lightRed":"text_Text--lightRed__+a5II","Text--lightYellow":"text_Text--lightYellow__PEHkc","Text--lightBlue":"text_Text--lightBlue__FH60G","Text--paleBlue":"text_Text--paleBlue__dyQar","Text--black":"text_Text--black__VI-fm","Text--richGrey":"text_Text--richGrey__ZSkDG","Text--greyDarker":"text_Text--greyDarker__4bx0M","Text--grey":"text_Text--grey__HNyNf","Text--lightGrey":"text_Text--lightGrey__94umS","Text--normalGrey":"text_Text--normalGrey__Wd8AZ","Text--white":"text_Text--white__35hOE","Text--yellow":"text_Text--yellow__NfP-8","Text--successTextColor":"text_Text--successTextColor__zEh++","Text--CICD":"text_Text--CICD__mE8h3","Text--CICDGrey":"text_Text--CICDGrey__Y+WJj","Text--CICDGreyDarker":"text_Text--CICDGreyDarker__TnUhM","Text--inputError":"text_Text--inputError__dEek4","Text--oceanBlue":"text_Text--oceanBlue__2egNj","Text--darkTheme":"text_Text--darkTheme__1mDlG","Text--darkGrey":"text_Text--darkGrey__gR6Cj","Text--tagGrey":"text_Text--tagGrey__diK0t","Text--mainPressed":"text_Text--mainPressed__raeaZ","Text--accentBorderFocused":"text_Text--accentBorderFocused__k+ywA","Text--accentPressed":"text_Text--accentPressed__GnViF","Text--cyan":"text_Text--cyan__xvguA","Text--tabSeparatorGrey":"text_Text--tabSeparatorGrey__4I-0M","Text--scrollbarThumbColor":"text_Text--scrollbarThumbColor__HqVL+","Text--yalo":"text_Text--yalo__nWQu3","Text--buttonFocusDarkTheme":"text_Text--buttonFocusDarkTheme__33uzY","Text--userMenuProfile":"text_Text--userMenuProfile__ishNP","Text--uppercase":"text_Text--uppercase__1iwzG","Text--ellipsis":"text_Text--ellipsis__2HK7Y","Text--inherit":"text_Text--inherit__b2tdq","Text--white-space-normal":"text_Text--white-space-normal__1pyh5","Text--white-space-nowrap":"text_Text--white-space-nowrap__dMU+v","Text--white-space-pre":"text_Text--white-space-pre__T-Vd1","Text--white-space-pre-wrap":"text_Text--white-space-pre-wrap__jZaT1","Text--white-space-pre-line":"text_Text--white-space-pre-line__GXrQu","Text--white-space-break-spaces":"text_Text--white-space-break-spaces__Q1LBD","Text--white-space-inherit":"text_Text--white-space-inherit__BbADs","Text--white-space-initial":"text_Text--white-space-initial__cxat-","Text--white-space-unset":"text_Text--white-space-unset__oriSE"}),xr="Text",Or=(0,n.memo)((({color:e="black",isUpperCase:t,size:r="h4",tagType:n="span",text:i,isEllipsis:o,whiteSpace:a,title:s,textRef:c})=>(0,Pr.jsx)(n,{ref:c,className:Dr(xr,{[`${xr}--${r}`]:Boolean(r),[`${xr}--${e}`]:Boolean(e),[`${xr}--white-space-${a}`]:Boolean(a),[`${xr}--uppercase`]:t,[`${xr}--ellipsis`]:o}),"data-name":"Text",title:s,children:i}))),kr="error-page",Ur=Lr().bind({Card:"card_Card__iCFhZ","Card__text-wrapper":"card_Card__text-wrapper__aXAWD",Card__text:"card_Card__text__2g+9W"}),Fr="Card",Mr=(0,n.memo)((()=>(0,Pr.jsx)("div",{className:Ur(`${Fr}`),children:(0,Pr.jsxs)("div",{className:Ur(`${Fr}__text-wrapper`),children:[(0,Pr.jsx)("div",{className:Ur(`${Fr}__text`),children:(0,Pr.jsx)(Or,{color:"black",size:"h0",text:c.default.t(`${kr}:title`)})}),(0,Pr.jsx)("div",{className:Ur(`${Fr}__text`),children:(0,Pr.jsx)(Or,{color:"black",size:"h3",text:c.default.t(`${kr}:text`)})})]})}))),qr=Lr().bind({"Error-page":"error-page-component_Error-page__tH9HN","Error-page__card-wrapper":"error-page-component_Error-page__card-wrapper__MmfYY"}),Br="Error-page",jr=(0,n.memo)((()=>(0,Pr.jsx)("div",{className:qr(Br),children:(0,Pr.jsx)("div",{className:qr(`${Br}__card-wrapper`),children:(0,Pr.jsx)(Mr,{})})}))),$r={angular:"angular",vue:"vue",react:"react"};var Gr=r(7164),Vr=r(37265),Wr=r.n(Vr);const Kr=/([A-Za-z0-9_.,]+)__([A-Za-z0-9_.,]+)__requests-cache/,Hr=async()=>{try{const e=performance.now(),t=[];console.log("%cpruneProjectsApiCaches run","color: blue;padding:3px;");const r=await caches.keys(),n=await(async e=>await e.reduce((async(e,t)=>{var r,n,i;const o=await e;if(!Kr.test(t))return o;const a=await caches.open(t),s=await a.keys(),c=null==s||null==(r=s[0])?void 0:r.url;if(!s.length||!c)return o;const l=await a.match(c),d=null!=(n=Number(null==l||null==(i=l.headers)||null==i.get?void 0:i.get("api-timestamp")))?n:0;if(!d)return o;const u=t.replace(Kr,"$1"),p={storageName:t,timestamp:d};return Object.assign({},o,{[u]:o[u]?[...o[u],p]:[p]})}),{}))(r);Promise.allSettled(Object.values(n).map((async e=>{try{e.length>2&&await(async({projectStorages:e,prunedCaches:t})=>{const r=e.sort(((e,t)=>t.timestamp-e.timestamp)).slice(3);r.length&&t.push(...r),await Promise.allSettled(r.map((async({storageName:e})=>{try{await caches.delete(e)}catch(t){console.error(t)}})))})({projectStorages:e,prunedCaches:t})}catch(r){console.error(r)}})));const i=performance.now();console.log("%cpruneProjectsApiCaches result","color: blue;padding:3px;",{duration:i-e,prunedCaches:t,prunedCachesCount:t.length})}catch(e){console.error("Error in pruneProjectsApiCaches",e)}};let zr=function(e){return e.FCP="Supplier_Basic_Front_Performance_FCP",e.LCP="Supplier_Basic_Front_Performance_LCP",e.INP="Supplier_Basic_Front_Performance_INP",e.CLS="Supplier_Basic_Front_Performance_CLS",e.TTFB="Supplier_Basic_Front_Performance_TTFB",e}({});class WebVitalsAnalyticsEventData{constructor(e){this.metricInstanceId=void 0,this.metricValue=void 0,this.metricDelta=void 0,this.metricRating=void 0,this.metricNavigationType=void 0,this.metricInstanceId=e.id,this.metricValue=e.value,this.metricDelta=e.delta,this.metricRating=e.rating,this.metricNavigationType=e.navigationType}}class WebVitalsAnalyticsEventDataWithNavEntry extends WebVitalsAnalyticsEventData{constructor(e){if(super(e),this.navigationEntryDuration=void 0,this.navigationEntryEntryType=void 0,this.navigationEntryName=void 0,this.navigationEntryStartTime=void 0,this.navigationEntryConnectEnd=void 0,this.navigationEntryConnectStart=void 0,this.navigationEntryDecodedBodySize=void 0,this.navigationEntryDomainLookupEnd=void 0,this.navigationEntryDomainLookupStart=void 0,this.navigationEntryEncodedBodySize=void 0,this.navigationEntryFetchStart=void 0,this.navigationEntryInitiatorType=void 0,this.navigationEntryNextHopProtocol=void 0,this.navigationEntryRedirectEnd=void 0,this.navigationEntryRedirectStart=void 0,this.navigationEntryRequestStart=void 0,this.navigationEntryResponseEnd=void 0,this.navigationEntryResponseStart=void 0,this.navigationEntrySecureConnectionStart=void 0,this.navigationEntryTransferSize=void 0,this.navigationEntryWorkerStart=void 0,this.navigationEntryActivationStart=void 0,this.navigationEntryDomComplete=void 0,this.navigationEntryDomContentLoadedEventEnd=void 0,this.navigationEntryDomContentLoadedEventStart=void 0,this.navigationEntryDomInteractive=void 0,this.navigationEntryLoadEventEnd=void 0,this.navigationEntryLoadEventStart=void 0,this.navigationEntryRedirectCount=void 0,this.navigationEntryType=void 0,this.navigationEntryUnloadEventEnd=void 0,this.navigationEntryUnloadEventStart=void 0,e.attribution.navigationEntry){const{duration:t,entryType:r,name:n,startTime:i,connectEnd:o,connectStart:a,decodedBodySize:s,domainLookupEnd:c,domainLookupStart:l,encodedBodySize:d,fetchStart:u,initiatorType:p,nextHopProtocol:E,redirectEnd:h,redirectStart:m,requestStart:g,responseEnd:_,responseStart:y,secureConnectionStart:S,transferSize:w,workerStart:v,activationStart:T,domComplete:A,domContentLoadedEventEnd:f,domContentLoadedEventStart:R,domInteractive:C,loadEventEnd:N,loadEventStart:b,redirectCount:I,type:L,unloadEventEnd:P,unloadEventStart:D}=e.attribution.navigationEntry;this.navigationEntryDuration=t,this.navigationEntryEntryType=r||void 0,this.navigationEntryName=n||void 0,this.navigationEntryStartTime=i,this.navigationEntryConnectEnd=o,this.navigationEntryConnectStart=a,this.navigationEntryDecodedBodySize=s,this.navigationEntryDomainLookupEnd=c,this.navigationEntryDomainLookupStart=l,this.navigationEntryEncodedBodySize=d,this.navigationEntryFetchStart=u,this.navigationEntryInitiatorType=p||void 0,this.navigationEntryNextHopProtocol=E||void 0,this.navigationEntryRedirectEnd=h,this.navigationEntryRedirectStart=m,this.navigationEntryRequestStart=g,this.navigationEntryResponseEnd=_,this.navigationEntryResponseStart=y,this.navigationEntrySecureConnectionStart=S,this.navigationEntryTransferSize=w,this.navigationEntryWorkerStart=v,this.navigationEntryActivationStart=T,this.navigationEntryDomComplete=A,this.navigationEntryDomContentLoadedEventEnd=f,this.navigationEntryDomContentLoadedEventStart=R,this.navigationEntryDomInteractive=C,this.navigationEntryLoadEventEnd=N,this.navigationEntryLoadEventStart=b,this.navigationEntryRedirectCount=I,this.navigationEntryType=L,this.navigationEntryUnloadEventEnd=P,this.navigationEntryUnloadEventStart=D}}}class WebVitalsAnalyticsEvent{constructor(e){this.name=void 0,this.params=void 0,this.params=this.adapt(e)}}class ClsAnalyticsEvent extends WebVitalsAnalyticsEvent{constructor(...e){super(...e),this.name=zr.CLS}adapt(e){return new ClsAnalyticsEventData(e)}}class ClsAnalyticsEventData extends WebVitalsAnalyticsEventData{constructor(e){var t,r,n,i,o,a;super(e),this.metricLoadState=void 0,this.largestShiftEntryDuration=void 0,this.largestShiftEntryType=void 0,this.largestShiftEntryName=void 0,this.largestShiftEntryStartTime=void 0,this.largestShiftEntryHadRecentInput=void 0,this.largestShiftEntryValue=void 0,this.largestShiftTarget=void 0,this.largestShiftTime=void 0,this.largestShiftValue=void 0,this.metricLoadState=e.attribution.loadState||void 0,this.largestShiftEntryDuration=null==(t=e.attribution.largestShiftEntry)?void 0:t.duration,this.largestShiftEntryType=(null==(r=e.attribution.largestShiftEntry)?void 0:r.entryType)||void 0,this.largestShiftEntryHadRecentInput=null==(n=e.attribution.largestShiftEntry)?void 0:n.hadRecentInput,this.largestShiftEntryName=(null==(i=e.attribution.largestShiftEntry)?void 0:i.name)||void 0,this.largestShiftEntryStartTime=null==(o=e.attribution.largestShiftEntry)?void 0:o.startTime,this.largestShiftEntryValue=null==(a=e.attribution.largestShiftEntry)?void 0:a.value,this.largestShiftTarget=e.attribution.largestShiftTarget||void 0,this.largestShiftTime=e.attribution.largestShiftTime,this.largestShiftValue=e.attribution.largestShiftValue}}class FcpAnalyticsEvent extends WebVitalsAnalyticsEvent{constructor(...e){super(...e),this.name=zr.FCP}adapt(e){return new FcpAnalyticsEventData(e)}}class FcpAnalyticsEventData extends WebVitalsAnalyticsEventDataWithNavEntry{constructor(e){var t,r,n,i;super(e),this.entryDuration=void 0,this.entryType=void 0,this.entryName=void 0,this.entryStartTime=void 0,this.metricFirstByteToFCP=void 0,this.metricLoadState=void 0,this.metricTimeToFirstByte=void 0,this.entryDuration=null==(t=e.attribution.fcpEntry)?void 0:t.duration,this.entryType=(null==(r=e.attribution.fcpEntry)?void 0:r.entryType)||void 0,this.entryName=(null==(n=e.attribution.fcpEntry)?void 0:n.name)||void 0,this.entryStartTime=null==(i=e.attribution.fcpEntry)?void 0:i.startTime,this.metricFirstByteToFCP=e.attribution.firstByteToFCP,this.metricLoadState=e.attribution.loadState||void 0,this.metricTimeToFirstByte=e.attribution.timeToFirstByte}}class InpAnalyticsEvent extends WebVitalsAnalyticsEvent{constructor(...e){super(...e),this.name=zr.INP}adapt(e){return new InpAnalyticsEventData(e)}}class InpAnalyticsEventData extends WebVitalsAnalyticsEventData{constructor(e){super(e),this.metricInputDelay=void 0,this.metricInteractionTarget=void 0,this.metricInteractionTime=void 0,this.metricInteractionType=void 0,this.metricLoadState=void 0,this.metricNextPaintTime=void 0,this.metricPresentationDelay=void 0,this.metricProcessingDuration=void 0,this.metricInputDelay=e.attribution.inputDelay,this.metricInteractionTarget=e.attribution.interactionTarget,this.metricInteractionTime=e.attribution.interactionTime,this.metricInteractionType=e.attribution.interactionType,this.metricLoadState=e.attribution.loadState,this.metricNextPaintTime=e.attribution.nextPaintTime,this.metricPresentationDelay=e.attribution.presentationDelay,this.metricProcessingDuration=e.attribution.processingDuration}}class LcpAnalyticsEvent extends WebVitalsAnalyticsEvent{constructor(...e){super(...e),this.name=zr.LCP}adapt(e){return new LcpAnalyticsEventData(e)}}class LcpAnalyticsEventData extends WebVitalsAnalyticsEventDataWithNavEntry{constructor(e){if(super(e),this.metricElement=void 0,this.metricElementRenderDelay=void 0,this.lcpEntryDuration=void 0,this.lcpEntryType=void 0,this.lcpEntryName=void 0,this.lcpEntryStartTime=void 0,this.lcpEntryId=void 0,this.lcpEntryLoadTime=void 0,this.lcpEntryRenderTime=void 0,this.lcpEntrySize=void 0,this.lcpEntryUrl=void 0,this.lcpResourceEntryDuration=void 0,this.lcpResourceEntryType=void 0,this.lcpResourceEntryName=void 0,this.lcpResourceEntryStartTime=void 0,this.lcpResourceEntryConnectEnd=void 0,this.lcpResourceEntryConnectStart=void 0,this.lcpResourceEntryDecodedBodySize=void 0,this.lcpResourceEntryDomainLookupEnd=void 0,this.lcpResourceEntryDomainLookupStart=void 0,this.lcpResourceEntryEncodedBodySize=void 0,this.lcpResourceEntryFetchStart=void 0,this.lcpResourceEntryInitiatorType=void 0,this.lcpResourceEntryNextHopProtocol=void 0,this.lcpResourceEntryRedirectEnd=void 0,this.lcpResourceEntryRedirectStart=void 0,this.lcpResourceEntryRequestStart=void 0,this.lcpResourceEntryResponseEnd=void 0,this.lcpResourceEntryResponseStart=void 0,this.lcpResourceEntrySecureConnectionStart=void 0,this.lcpResourceEntryTransferSize=void 0,this.lcpResourceEntryWorkerStart=void 0,this.metricResourceLoadDelay=void 0,this.metricResourceLoadDuration=void 0,this.metricTimeToFirstByte=void 0,this.metricUrl=void 0,this.metricElement=e.attribution.element||void 0,this.metricElementRenderDelay=e.attribution.elementRenderDelay,this.metricResourceLoadDelay=e.attribution.resourceLoadDelay,this.metricResourceLoadDuration=e.attribution.resourceLoadDuration,this.metricTimeToFirstByte=e.attribution.timeToFirstByte,this.metricUrl=e.attribution.url||void 0,e.attribution.lcpEntry){const{duration:t,entryType:r,name:n,startTime:i,id:o,loadTime:a,renderTime:s,size:c,url:l}=e.attribution.lcpEntry;this.lcpEntryDuration=t,this.lcpEntryType=r||void 0,this.lcpEntryName=n||void 0,this.lcpEntryStartTime=i,this.lcpEntryId=o||void 0,this.lcpEntryLoadTime=a,this.lcpEntryRenderTime=s,this.lcpEntrySize=c,this.lcpEntryUrl=l||void 0}if(e.attribution.lcpResourceEntry){const{duration:t,entryType:r,name:n,startTime:i,connectEnd:o,connectStart:a,decodedBodySize:s,domainLookupEnd:c,domainLookupStart:l,encodedBodySize:d,fetchStart:u,initiatorType:p,nextHopProtocol:E,redirectEnd:h,redirectStart:m,requestStart:g,responseEnd:_,responseStart:y,secureConnectionStart:S,transferSize:w,workerStart:v}=e.attribution.lcpResourceEntry;this.lcpResourceEntryDuration=t,this.lcpResourceEntryType=r||void 0,this.lcpResourceEntryName=n||void 0,this.lcpResourceEntryStartTime=i,this.lcpResourceEntryConnectEnd=o,this.lcpResourceEntryConnectStart=a,this.lcpResourceEntryDecodedBodySize=s,this.lcpResourceEntryDomainLookupEnd=c,this.lcpResourceEntryDomainLookupStart=l,this.lcpResourceEntryEncodedBodySize=d,this.lcpResourceEntryFetchStart=u,this.lcpResourceEntryInitiatorType=p||void 0,this.lcpResourceEntryNextHopProtocol=E||void 0,this.lcpResourceEntryRedirectEnd=h,this.lcpResourceEntryRedirectStart=m,this.lcpResourceEntryRequestStart=g,this.lcpResourceEntryResponseEnd=_,this.lcpResourceEntryResponseStart=y,this.lcpResourceEntrySecureConnectionStart=S,this.lcpResourceEntryTransferSize=w,this.lcpResourceEntryWorkerStart=v}}}class TtfbAnalyticsEvent extends WebVitalsAnalyticsEvent{constructor(...e){super(...e),this.name=zr.TTFB}adapt(e){return new TtfbAnalyticsEventData(e)}}class TtfbAnalyticsEventData extends WebVitalsAnalyticsEventDataWithNavEntry{constructor(e){super(e),this.metricCacheDuration=void 0,this.metricConnectionDuration=void 0,this.metricDnsDuration=void 0,this.metricRequestDuration=void 0,this.metricWaitingDuration=void 0,this.metricCacheDuration=e.attribution.cacheDuration,this.metricConnectionDuration=e.attribution.connectionDuration,this.metricDnsDuration=e.attribution.dnsDuration,this.metricRequestDuration=e.attribution.requestDuration,this.metricWaitingDuration=e.attribution.waitingDuration}}const Jr=(0,x.PerformanceTrackHOC)({componentEventName:"AppLoaded",mountedCallback:()=>{"PerformanceLongTaskTiming"in window||x.performanceMonitor.sendMeasurements()}})((({content:e,framework:t,router:r,route:i})=>((0,n.useEffect)((()=>{t&&$r[t]&&e({router:r})}),[e,t,r]),t===$r.vue?(0,Pr.jsx)("div",{id:"vue-root-container",children:(0,Pr.jsx)("div",{id:"vue-root"})},i.name):t===$r.angular?(0,Pr.jsx)("angular-root",{}):t===$r.react?(0,Pr.jsx)("div",{id:"react-root"}):e))),Xr=()=>(0,Pr.jsx)(a.RouteNode,{nodeName:"",children:({content:e,framework:t,router:r,route:n})=>(0,Pr.jsx)(Jr,{content:e,framework:t,route:n,router:r})}),Yr=(0,n.memo)((({platformModules:e,platformModules:{Layout:t,ErrorPage:r,Preview:n},platformLoaded:i,translationIsLoading:o,handleLogout:a,coreRequestsError:s,coreRequestsErrorCode:c,firstRouteTransitionFinished:l,appVersion:d,isLogoutLoading:u})=>i?!t&&i||s?r?(0,Pr.jsx)(r,{appVersion:d,errorCode:c}):(0,Pr.jsx)(jr,{}):(0,Pr.jsx)(t,{appVersion:d,firstRouteTransitionFinished:l,handleLogout:a,isLogoutLoading:u,platformModules:e,previewPage:n,routeContent:Xr,translationIsLoading:o}):n?(0,Pr.jsx)(n,{appVersion:d}):(0,Pr.jsx)(Pr.Fragment,{}))),Qr=(0,x.PerformanceTrackHOC)({componentEventName:"Root"})(Yr),Zr=(0,n.memo)((({productsMenuIsLoading:e,userInfoIsLoading:t,platformModules:r,platformModulesIsLoading:i,userPermissionsIsLoading:o,translationIsLoading:a,rootInitLoading:s,logout:c,coreRequestsError:l,loginLoading:d,coreRequestsErrorCode:u,firstRouteTransitionFinished:p,appVersion:E,isLogoutLoading:h})=>{const[m,g]=(0,n.useState)(!1),_=(({userInfoIsLoading:e,userPermissionsIsLoading:t,productsMenuIsLoading:r,platformModulesIsLoading:n,platformLoaded:i,rootInitLoading:o,loginLoading:a})=>(a||e||o||t||r||n)&&!i)({userInfoIsLoading:t,userPermissionsIsLoading:o,productsMenuIsLoading:e,platformModulesIsLoading:i,platformLoaded:m,rootInitLoading:s,loginLoading:d});(0,n.useEffect)((()=>{_||g(!0)}),[_]);const y=(0,n.useCallback)((()=>{c()}),[c]);return(0,Pr.jsx)(Qr,{appVersion:E,coreRequestsError:l,coreRequestsErrorCode:u,firstRouteTransitionFinished:p,handleLogout:y,isLogoutLoading:h,platformLoaded:m,platformModules:r,translationIsLoading:a})})),en={logout:pe},tn=(0,w.compose)(u.withRouter,(0,_.connect)((e=>({userInfoIsLoading:(0,p.getUserInfoIsLoading)(e),userPermissionsIsLoading:(0,p.getUserPermissionsIsLoading)(e),productsMenuIsLoading:(0,d.getProductsMenuIsLoading)(e),platformModules:Z(e),platformModulesIsLoading:ee(e),translationIsLoading:Le(e),rootInitLoading:Pe(e),loginLoading:De(e),coreRequestsError:xe(e),coreRequestsErrorCode:Oe(e),firstRouteTransitionFinished:Ue(e),isLogoutLoading:Fe(e)})),en))(Zr),rn=(0,n.memo)((()=>(0,Pr.jsx)(Pr.Fragment,{}))),nn=({store:e})=>(0,Pr.jsxs)(_.Provider,{store:e,children:[(0,Pr.jsx)(rn,{}),(0,Pr.jsx)(tn,{})]});var on=r(59145);const an=({cacheKey:e,strategy:t})=>Object.assign({},Ke,{strategy:t||"NetworkFirst",requestCacheKey:e}),sn=({supplierId:e,strategy:t,userId:r,featuresFilterList:n,isNgABACEnabled:i=!1})=>{if(e)try{return{key:e,scope:window.ENVS.MAIN_ABAC_SCOPE,ignoreResponseIdCompare:!0,featuresFilterList:(0,p.getFormattedFilteredFeatures)(n),browserCacheParams:e&&r?an({cacheKey:`get-abac-features-request-${e}-${r}${i?"-ng":""}`,strategy:t}):void 0}}catch(o){return console.error("error in getInitialAbacParams function",o),E.sentryLogger.sendError({error:o,project:Ge,message:"error in getInitialAbacParams function"}),{scope:window.ENVS.MAIN_ABAC_SCOPE,key:null,ignoreResponseIdCompare:!0,featuresFilterList:n}}return{scope:window.ENVS.MAIN_ABAC_SCOPE,ignoreResponseIdCompare:!0,featuresFilterList:n}},cn=({onUpdateCache:e,strategy:t,userId:r})=>Object.assign({},Ke,{strategy:t||"NetworkFirst",requestCacheKey:`${r}-personal_data`,onUpdateCache:e}),ln=({getCookie:e})=>{const t=window.INIT_ABAC_PARAMS_FUNCTION;if(t)try{const r=new Function(`return ${t}`)();return Object.assign({},r({getCookie:e}))}catch(r){return console.error("error in getSupplierIdfromCookie",r),{key:""}}return{key:""}};function dn(e){if("object"!=typeof e||null===e)return e;const t={};return Object.keys(e).forEach((r=>{t[r]=dn(e[r])})),t}const un=e=>{try{const t=dn((0,p.getAllPermissionsData)(e.getState()));!function(e,t){if(!t||!Array.isArray(t))return!1;const r=function(e,t){return t.slice(0,-1).reduce(((e,t)=>null==e?void 0:e[t]),e)||null}(e,t);if(r)return delete r[t[t.length-1]]}(t,[D.AB_EXPERIMENTS_SCOPE,D.AB_EXPERIMENTS_ABAC_FEATURE]),e.dispatch((0,p.setUserDataPermissionsAction)({permissionsData:t})),(0,D.setDataPermissionsAction)(t)}catch(t){console.error("Error in updateAbExperimentsAfterSupplierChange",t)}},pn=window.ENVS.ROOT_ABAC_FEATURES||[],En=window.ENVS.MAIN_ABAC_SCOPE||"",hn=({middlewaresAreDisabled:e})=>(new h.PureRestRequest).getRequest({endpoint:Ct,isErrorTextStraightToOutput:!0,credentials:"include",responseSchema:T().object({error:T().string(),sessionID:T().string(),userID:T().number()}),retry:2,extraVerifyRetry:Be,tracingDisabled:!0,middlewaresAreDisabled:e,notRetryWhenOffline:!0,customTimeout:1e4}),mn={NX_PUBLIC_ENABLE_DYNAMIC_CDN:"true",NX_PUBLIC_LOGOUT_REQUIRED_EXTERNAL_ORIGINS:"${LOGOUT_REQUIRED_EXTERNAL_ORIGINS}",NX_PUBLIC_PUBLIC_PATH:"https://static-basket-02.wbbasket.ru/vol20/root-monorepo/latest/",NX_PUBLIC_ADDITIONAL_MENU_CONFIG:"${ADDITIONAL_MENU_CONFIG}",NX_PUBLIC_ENDPOINTS:"${ENDPOINTS}",NX_PUBLIC_LANGUAGES_FALLBACK:"${LANGUAGES_FALLBACK}",NX_PUBLIC_STATIC_PATH:"/vol20/root-monorepo/latest/",NX_PUBLIC_TRUSTED_ZONES:"${TRUSTED_ZONES}",NX_PUBLIC_ENVS:"${ENVS}",NX_PUBLIC_ROOT_URLS:"${ROOT_URLS}",NX_PUBLIC_INIT_ABAC_PARAMS_FUNCTION:"${INIT_ABAC_PARAMS_FUNCTION}",NX_PUBLIC_STATIC_HOST:"https://static-basket-02.wbbasket.ru",NX_PUBLIC_APP_VERSION:"v1.25.0",NX_PUBLIC_FETCH_MENU_CACHE_KEY_FUNCTION:"${FETCH_MENU_CACHE_KEY_FUNCTION}"}.PUBLIC_URL,gn=()=>(new h.PureRestRequest).getRequest({endpoint:`${mn}/manifest.json`,isErrorTextStraightToOutput:!0,tracingDisabled:!0,pureJsonFileResponse:!0}),_n=r.p+"en.675fdca00c4baf25.json",yn=r.p+"ru.9222cc7ccbc9796f.json",Sn=r.p+"cn.0ee67634707808fc.json",wn=r.p+"tr.a5de91cb23944702.json",vn=r.p+"ka.88330d71bf260e38.json",Tn="ru",An="en",fn="cn",Rn="zh",Cn="tr",Nn="ka",bn={[Tn]:yn,[An]:_n,[fn]:Sn,[Rn]:Sn,[Cn]:wn,[Nn]:vn},In=r.p+"en.24d79f731b94eb0b.json",Ln=r.p+"ru.7e35dbbafee0bf4f.json",Pn=r.p+"cn.97b568928f050b2f.json",Dn={en:In,ru:Ln,cn:Pn,zh:Pn,tr:r.p+"tr.d5ecab54c984cbb5.json",ka:r.p+"ka.6d407232c0116862.json"};var xn=r(18842);const On=e=>(new h.PureRestRequest).postRequest((({token:e,endpoint:t="",isCurrentDomainEndpoint:r=!0,middlewaresAreDisabled:n})=>({translateFunction:()=>"",endpoint:r?Ft:`${t}${wt}`,headers:{AuthorizeV3:e},credentials:"include",middlewaresAreDisabled:n}))(e)),kn={};function Un(e,t){return kn[e]||(kn[e]=t().finally((()=>{delete kn[e]}))),kn[e]}const Fn=async()=>{var e,t;const r=new h.PureRestRequest;return await r.postRequest({endpoint:window.__ENDPOINTS__.VALIDATE_TOKEN,credentials:"include",parseType:"text",middlewaresAreDisabled:!0}),403!==(null==(e=r.response)?void 0:e.status)&&401!==(null==(t=r.response)?void 0:t.status)};class ValidateTokenError extends Error{constructor(e,t){super(e),this.message=e,this.code=t}}const Mn=async e=>{if(window.ENVS.USE_UPGRADE_COOKIE){(({code:e,headers:t,errorText:r,error:n})=>{if(n){if(e===h.OFFLINE_STATUS_CODE||e===xn.REQUEST_ERROR_STATUS_CODE&&!Object.keys(t).length)throw new ValidateTokenError(r,h.OFFLINE_STATUS_CODE);throw new ValidateTokenError(r,e)}})(await On({token:e,middlewaresAreDisabled:!0}))}if(!(await Fn()))throw new ValidateTokenError("Unauthorized");return!0},qn=e=>Un("validationToken",(()=>Mn(e))),Bn=async()=>{const e=localStorage.getItem(He)||"";if(!e)throw new Error;try{if(await qn(e),!(await SodiumKeyPair.fromLocalStorage(hr))){const t=await SodiumKeyPair.generate(hr);await t.save(e)}}catch(t){if((null==t?void 0:t.code)===h.OFFLINE_STATUS_CODE)return!0;throw localStorage.removeItem(He),t}return!0},jn=T().object({result:T().number().required(),error:T().any().when("result",{not:T().valid(0),then:T().string().required(),otherwise:T().forbidden()}),payload:T().any().when("result",{is:T().valid(0),then:T().object({access_token:T().string().required()})})}),$n=e=>(new h.PureRestRequest).postRequest((({middlewaresAreDisabled:e})=>({endpoint:jt,responseSchema:jn,middlewaresAreDisabled:e,credentials:"include",headers:Object.assign({},Jt)}))(e)),Gn=T().object({result:T().number().required(),error:T().any().when("result",{not:T().valid(0),then:T().string().required(),otherwise:T().forbidden()})}),Vn=e=>(new h.PureRestRequest).postRequest((({sticker:e,middlewaresAreDisabled:t})=>({middlewaresAreDisabled:t,endpoint:$t,responseSchema:Gn,body:{sticker:e},credentials:"include",headers:Object.assign({},Jt)}))(e)),Wn=async()=>{const{data:{result:e,payload:t,error:r}}=await $n({middlewaresAreDisabled:!0}),n=null==t?void 0:t.access_token;if(0!==e){if(12===e)throw new RefreshTokenCookieUnavailable;throw new Error(r)}const{data:{error:i,result:o}}=await Vn({sticker:null==t?void 0:t.sticker,middlewaresAreDisabled:!0});if(0!==o)throw new Error(i);return localStorage.setItem(He,n),await qn(n),!0},Kn=async()=>{if(!window.ENVS.ENABLE_AUTH_V3)throw new RefreshTokenCookieUnavailable;return Un("verifyExistingToken",Bn).catch((()=>Un("getNewToken",Wn))).catch((e=>{throw console.error(e),new RefreshTokenCookieUnavailable}))},Hn=()=>Un("authViaV3",Kn),zn="offline",Jn=({code:e,headers:t})=>{if(void 0!==navigator.onLine&&!navigator.onLine||e===h.OFFLINE_STATUS_CODE||e===xn.REQUEST_ERROR_STATUS_CODE&&!Object.keys(t).length)throw new Error(zn)},Xn=async({userId:e,supplierId:t,onUpdateCache:r,isNgABACEnabled:n=!1,isBrowserCacheEnabled:i=!0})=>{try{const o=t&&e&&i?Object.assign({},an({strategy:"StaleWhileRevalidate",cacheKey:`${je}-${t}-${e}${n?"-ng":""}`}),{onUpdateCache:r}):null,{data:a}=await(0,p.loadUserPermissionBatchedRequest)({features:Cr(t||""),browserCacheParams:o,isNgABACEnabled:n});return a}catch(o){return console.error("[fetchUserPermissionsData] get an error",o),null}},Yn=e=>(new h.PureRestRequest).getRequest((({browserCacheParams:e})=>({endpoint:window.__ENDPOINTS__.CDN_CONFIG_ENDPOINT,isErrorTextStraightToOutput:!0,browserCacheParams:e}))(e)),Qn=({strategy:e,cacheKey:t,onUpdateCache:r,onRequestError:n})=>Object.assign({},Ke,{strategy:e||"NetworkFirst",requestCacheKey:t,onUpdateCache:r,onRequestError:n}),Zn="Supplier_CDN_Error",ei=({dispatch:e,permissions:t,scope:r})=>{try{const n=(0,p.getFormattedPermissions)({data:t,scope:r});e((0,p.setUserPermissionsAction)({permissions:n})),(0,D.setPermissionsAction)(n)}catch(n){e((0,p.setUserPermissionsAction)({permissions:{[r]:{}}}))}},ti=()=>{const{userAgent:e}=window.navigator,t=We.find((t=>t.platform.test(e)));return t?t.device:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430"},ri=({formattedResponseData:{code:e,error:t}})=>!!t&&(401!==e&&400!==e),ni=()=>{const{userAgent:e}=window.navigator;return Object.keys(Ve).reduce(((t,r)=>{if(t)return t;if(e.indexOf(r)>-1){const t=Ve[r],n=(({browserName:e,userAgent:t})=>{const r=new RegExp(`${"Safari"===e?"Version":e}/\\d+.\\d+`),n=t.match(r);return n?n[0].split("/").pop():""})({browserName:r,userAgent:e});return`${t} ${n}`}return t}),"")||"Unknown Browser"},ii=({options:e,token:t,device:r,version:n,endpoint:i,middlewaresAreDisabled:o})=>(new h.RestRequest).postRequest({endpoint:i,body:{options:e,token:t,device:r,version:n},isErrorTextStraightToOutput:!0,credentials:"include",retry:2,extraVerifyRetry:Be,tracingDisabled:!0,middlewaresAreDisabled:o,extraValidationCallback:({statusCode:e})=>200===e}),oi=({endpoint:e,middlewaresAreDisabled:t})=>(new h.PureRestRequest).postRequest({endpoint:e,body:{},responseSchema:T().object({error:T().string().allow(""),token:T().string()}),isErrorTextStraightToOutput:!0,credentials:"include",retry:2,extraVerifyRetry:Be,tracingDisabled:!0,middlewaresAreDisabled:t}),ai=async({middlewaresAreDisabled:e})=>{const t=ni(),r=ti(),{data:{token:n,error:i},error:o,errorText:a}=await oi({endpoint:Tt,middlewaresAreDisabled:e});if(i||!n||o)return console.error("get grantLocalErrorText:",a),!0;const{additionalErrors:s}=await ii({token:n,device:r,version:t,endpoint:Rt,middlewaresAreDisabled:e});return!s||!s.error||(console.error("get loginCentralAdditionalErrors:",s.error),!0)},si=ti(),ci=async({middlewaresAreDisabled:e})=>{try{return await(async({middlewaresAreDisabled:e})=>{const t=ni(),r=ti(),{data:{token:n,error:i},error:o,errorText:a,code:s,headers:c}=await oi({endpoint:At,middlewaresAreDisabled:e});if(i||!n||o)throw Jn({code:s,headers:c}),Error(i||a);const{additionalErrors:l,code:d,headers:u}=await ii({token:n,device:r,version:t,endpoint:ft,middlewaresAreDisabled:e});if(l&&l.error)throw Jn({code:d,headers:u}),Error(l.error);return!0})({middlewaresAreDisabled:e}),await ai({middlewaresAreDisabled:e}),!0}catch(t){if(t.message===zn)return!0;const r=void 0!==navigator.onLine&&!navigator.onLine,{error:n,errorText:i,code:o,headers:a}=await(({device:e,middlewaresAreDisabled:t})=>(new h.PureRestRequest).postRequest({endpoint:Nt,isErrorTextStraightToOutput:!0,credentials:"include",body:{device:e},retry:2,extraVerifyRetry:ri,tracingDisabled:!0,middlewaresAreDisabled:t,extraValidationCallback:({statusCode:e})=>200===e}))({device:si,middlewaresAreDisabled:e});if(r||o===h.OFFLINE_STATUS_CODE||o===xn.REQUEST_ERROR_STATUS_CODE&&!Object.keys(a).length)return!0;if(n)throw Error(i);return await ai({middlewaresAreDisabled:e}),!0}},li=async({store:e,router:t})=>{try{await Promise.all([r.e(410),r.e(676),r.e(700),r.e(379),r.e(592),r.e(322),r.e(573)]).then(r.bind(r,18573)).then((({externalPackages:r,registrationSaga:n,registrationReducer:i,registrationDependencies:o,registrationActions:a})=>{var s;r&&e.setDependencies(Object.assign({},e.dependencies,{externalPackages:Object.assign({},null==(s=e.dependencies)?void 0:s.externalPackages,r)}));a&&a(),n&&n({store:e}),i&&i({store:e}),o&&o({store:e,router:t})}))}catch(n){console.error("fetchExternalPackagesWorkerSaga get an error",n.message)}},di=({dispatch:e,userInfo:t})=>{try{if(!t)return;e((0,p.setUserInfoAction)({userInfo:t})),(0,D.setUserDataAction)(t)}catch(r){e((0,p.setUserPermissionsAction)({permissions:{[window.ENVS.MAIN_ABAC_SCOPE]:{}}}))}},ui=({supplierId:e,store:t,responseData:r,withPermissionsMerge:n})=>{try{if(!r)return;const i=Cr(e||""),o=(0,p.getFormattedDataABACRefreshResponse)({fullResponse:r,initialValues:i}),a=n?((e,t)=>{const r=(0,p.getAllPermissionsData)(e.getState());return(0,p.getRefreshedPermissions)({currentPermissions:r,newPermissions:t})})(t,o):o;t.dispatch((0,p.setUserDataPermissionsAction)({permissionsData:a})),(0,D.setDataPermissionsAction)(a)}catch(i){console.error("[formatPermissionsDataAndDispatch] get an error",i)}},pi="@root/FETCH_LOGIN_NAVIGATION",Ei=()=>({type:pi}),hi=window.LANGUAGES_FALLBACK,mi=window.ENVS.ROOT_ABAC_FEATURES||[],gi=window.ENVS.MAIN_ABAC_SCOPE||"",_i=/(localhost)|(http:\/\/)/.test(window.origin),yi=window.ENVS.LOCALE_WILDCARD_DOMAIN||N.currentZone,Si=window.__ROOT_URLS__;var wi=r(65437);function*vi(){const e=(0,l.getLocale)({isFromCookie:!0,supportedLocales:window.LANGUAGES_FALLBACK,localesMap:qe});try{try{yield(0,te.RE)(Hn)}catch(t){if(void 0!==navigator.onLine&&!navigator.onLine)return;if(!(t instanceof RefreshTokenCookieUnavailable))throw t;const{error:e,code:r,headers:n}=yield(0,te.RE)(hn,{});if(!e||r===h.OFFLINE_STATUS_CODE||r===xn.REQUEST_ERROR_STATUS_CODE&&!Object.keys(n).length)return;yield(0,te.RE)(ci,{})}}catch(r){et(),Ze(e)}}const Ti="LOGIN_NAVIGATION_SAGA_NAME";const Ai="Navigation error";window.cachedWindowEnvs=new Map;const fi=()=>{const e=window.matchMedia("(display-mode: standalone)").matches;return!!document.referrer.startsWith("android-app://")||!(!navigator.standalone&&!e)},Ri=e=>{try{if(!e||"object"!=typeof e)return;return Object.keys(e).reduce(((t,r)=>{const{data:n,decision:i}=e[r];return n&&null!=n&&n.expID&&(t[n.expID]=Object.assign({},n,{decision:Boolean(i)})),t}),{})}catch(t){return console.error("Error in formatDataToSpits",t),{}}},Ci=()=>{const e=(0,D.abExperimentsSelector)(),t=(0,l.getLocale)({isFromCookie:!0,supportedLocales:window.LANGUAGES_FALLBACK,localesMap:qe});return{idUser:(0,D.userDataSelector)().id,idSupplier:ln({getCookie:vr}).key,splits:JSON.stringify(Ri(e)),uiRootVersion:"v1.25.0",uiRootBuildTime:1738839951538,language:t}},Ni=e=>!e||(e.startsWith("/")||e.startsWith(window.location.origin)),bi=e=>async({endpoint:t,pureRequestParams:r,response:n,retryRequest:i})=>{const o=t.includes("/ns/ng-abac-access/"),a=t.includes("/ns/abac/");if(!Ni(t)&&200!==n.code&&(a||o)){var s,c;const t=(0,p.getUserAllPermissions)(e.getState());if(null==t||null==(s=t[Ar])?void 0:s[fr]){const t=await i({endpoint:`${window.__ENDPOINTS__.ROOT_ENDPOINT_NG_ABAC}?fallback`,middlewaresAreDisabled:!0});if(200===t.code)return t;{const t={features:{permitted:{[fr]:!1}}},r=(0,p.getFormattedPermissions)({data:t,scope:Ar}),n=(0,p.getRefreshedPermissions)({currentPermissions:(0,p.getUserAllPermissions)(e.getState()),newPermissions:r});e.dispatch((0,p.setUserPermissionsAction)({permissions:n})),(0,D.setPermissionsAction)(n)}}const n=JSON.parse(null!=(c=r.requestBody)?c:"{}"),a=Array.isArray(n),l=((e=!1)=>t=>{var r,n,i;return Object.assign({},t,{method:null==(r=t.method)?void 0:r.replace(e?"abac.":"abacv2.",e?"abacv2.":"abac."),params:Object.assign({},t.params,e?{key:null==(n=t.params)?void 0:n.object,object:void 0}:{object:null==(i=t.params)?void 0:i.key,key:void 0})})})(o),d=await i(Object.assign({endpoint:window.__ENDPOINTS__.ROOT_ENDPOINT_ABAC,middlewaresAreDisabled:!0},o?{body:a?n.map(l):l(n)}:{}));if(200===d.code)return d}return n},Ii=async({endpoint:e,response:t,retryRequest:r})=>{if([500,502,504].includes(t.code)&&window.ENVS.ENABLE_CDN_V3){const n=(0,N.findUrlWithFallback)(e);if(!n||n===e)return t;O.analyticsEventEmitter.sendEvent({name:Zn,customEvent:!0,params:{recommendedUrl:e,originalUrl:n,status:t.code}});return await r({middlewaresAreDisabled:!0,endpoint:n})}return t};let Li;const Pi=e=>e.startsWith("https://")&&Object.hasOwn((Li||(Li=window.TRUSTED_ZONES.reduce(((e,t)=>(e[`https://${(0,N.resolveUrl)(t)}`]=!0,e)),{})),Li),new URL(e).origin),Di=/^\/[#\x2D0-9\?A-Z_a-z]/,xi=e=>{const t=(r=e.endpoint,Di.test(r));var r;const n=!t&&Pi(e.endpoint),{__ENDPOINTS__:{LOAD_MENU_REQUEST_ENDPOINT:i,LOAD_MENU_FILE_REQUEST_ENDPOINT:o}}=window,a=i&&-1!==e.endpoint.indexOf(i),s=o&&-1!==e.endpoint.indexOf(o);return(t||n)&&!a&&!s};var Oi=r(29699);const ki=async e=>{var t;const r=await(({endpoint:e,deviceId:t,middlewaresAreDisabled:r})=>(new h.JSONRPCRequest).makeRequest({endpoint:e,body:{params:{deviceID:t}},middlewaresAreDisabled:r,credentials:"include"}))({endpoint:Wt,deviceId:e,middlewaresAreDisabled:!0}),{data:{sticker:n},error:i,additionalErrors:o}=r;if(null!=o&&null!=(t=o.data)&&t.ttl){const{hours:e,minutes:t,seconds:r}=(e=>{if(!e)return{hours:0,minutes:0,seconds:0};const t=Math.floor(e/3600),r=Math.floor(e%3600);return{hours:t,minutes:Math.floor(r/60),seconds:Math.floor(r%60)}})(o.data.ttl),n=(0,l.getLocale)({isFromCookie:!0,supportedLocales:window.LANGUAGES_FALLBACK,localesMap:qe});throw new Error(c.default.t(Ye.reachedLimit,{duration:new Oi.DurationFormat(n,{style:"short"}).format({hours:e,minutes:t,seconds:r})}))}if(i)throw new Error(c.default.t(Ye.requestError));return n},Ui=async({code:e,sticker:t,deviceId:r})=>{const n={code:e,sticker:t,deviceID:r},{error:i,errorText:o}=await(({endpoint:e,middlewaresAreDisabled:t,params:r})=>(new h.JSONRPCRequest).makeRequest({endpoint:e,body:{params:r},middlewaresAreDisabled:t,credentials:"include"}))({endpoint:Kt,middlewaresAreDisabled:!0,params:n});if(i)throw new Error(`Error in mfa validate ${o}`);return!0},Fi=async({retryRequest:e,isRpc:t})=>{const r=Er();try{const{sticker:t}=await ki(r);(0,D.setUserCriticalActionCode)(null),(0,D.setIsCriticalActionIncorrectCode)(!1),(0,D.setIsUserCriticalAction)(!0);const n=await(async({retryRequest:e,sticker:t,deviceId:r})=>new Promise(((n,i)=>{(0,D.setUserDataCriticalActionCodeListener)((async({criticalActionCode:o})=>{if(!(0,D.userDataIsCriticalActionSelector)())return void i(c.default.t(Ye.abortEnterCodeError));if(!o)return;const a=await Ui({code:o,sticker:t,deviceId:r}).then((()=>!0),(()=>!1));a&&n(await e()),(0,D.setIsCriticalActionIncorrectCode)(!a),(0,D.setUserSendCodeLoadingAction)(!1)}))})).finally(D.removeUserDataCriticalActionCodeListener))({retryRequest:e,sticker:t,deviceId:r});return n}catch(n){const e=String(n.message||n);(0,D.setCriticalActionErrorEvent)({errorText:e});const r=c.default.t(`${$e}:backend-errors.failed-to-confirm-action`);return t?new Response(JSON.stringify({id:"json-rpc_???",jsonrpc:"2.0",error:{code:-32007,message:r,data:{message:r}}})):new Response(JSON.stringify({error:!0,errorText:r,data:null,additionalErrors:{reasonCode:h.ErrorReason.CriticalAction}}),{status:500,statusText:"critical action error"})}finally{(0,D.setIsUserCriticalAction)(!1)}},Mi=e=>!!e&&(!Ni(e)||or.test(e)),qi=async e=>{const t=ni(),r=ti();await hn({});const n=await(async()=>{const{data:{token:e}}=await oi({endpoint:At,middlewaresAreDisabled:!0});if(e)return e;await ai({middlewaresAreDisabled:!0});const{data:{token:t,error:r,errorText:n}}=await oi({endpoint:At,middlewaresAreDisabled:!0});if(r)throw new Error(n);return t})(),{error:i,errorText:o}=await ii({token:n,device:r,version:t,endpoint:`${e}/passport/api/v2/auth/login`,middlewaresAreDisabled:!0});if(i)throw new Error(`Error in domain login ${o}`);return!0},Bi=e=>Un(e,(()=>Hn().then((()=>(async e=>{const t=localStorage.getItem(He)||"";if(!t)throw new Error;if(!window.ENVS.USE_UPGRADE_COOKIE)return!0;const{data:r,errorText:n}=await On({isCurrentDomainEndpoint:!1,endpoint:e,token:t});if("true"!==r.success)throw new Error(n);return!0})(e))).catch((t=>{if(t instanceof RefreshTokenCookieUnavailable)return qi(e).then((()=>!0));throw t})))),ji=async({pureRequestParams:e,retryRequest:t,response:r})=>{try{if(!Mi(e.endpoint))return r;const n=sr(e.endpoint);if((e=>{try{const t=ir(nr());t.push(e);const r=t.reduce(((e,t)=>(e.includes(t)||e.push(t),e)),[]);localStorage.setItem(ze,JSON.stringify(r))}catch(t){}})(n),!r.error||r.code===h.OFFLINE_STATUS_CODE)return r;if(!(({responseBodyJson:e,code:t})=>t!==h.OFFLINE_STATUS_CODE&&(401===t||403===t||-1!==e.indexOf("empty:user id")||-1!==e.indexOf("unauthorized")||-1!==e.indexOf("authorization error")||-1!==e.indexOf("\u041d\u0435 \u0410\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d")))({responseBodyJson:JSON.stringify(e.responseBody),code:e.code}))return r;await Bi(n);return await t({middlewaresAreDisabled:!0})}catch(n){return console.error("loginSeparateDomainMiddleware error",n),r}},$i=()=>Un("loginApi",(()=>Hn().catch((e=>{if(e instanceof RefreshTokenCookieUnavailable)return(async()=>{const{error:e}=await hn({middlewaresAreDisabled:!0});return e&&await ci({middlewaresAreDisabled:!0}),!0})().then((()=>!0));throw e})))),Gi=async({pureRequestParams:e,retryRequest:t,response:r})=>{if(!r.error||r.code===h.OFFLINE_STATUS_CODE)return r;const n=(0,l.getLocale)({isFromCookie:!0,supportedLocales:window.LANGUAGES_FALLBACK,localesMap:qe});try{if(Mi(e.endpoint))return r;if(!(({responseBodyJson:e,code:t})=>t!==h.OFFLINE_STATUS_CODE&&(401===t||-1!==e.indexOf("empty:user id")||-1!==e.indexOf("unauthorized")||-1!==e.indexOf("authorization error")||-1!==e.indexOf("\u041d\u0435 \u0410\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d")))({responseBodyJson:JSON.stringify(e.responseBody),code:e.code}))return r;await $i();return await t({middlewaresAreDisabled:!0})}catch(i){return console.error("loginMiddleware error",i),et(),Ze(n),r}},Vi=e=>{const t=new h.InterceptorsController;t.addResponseInterceptor(((e,{retry:t,requestProtocol:r})=>{return n=e.status,window.ENVS.MFA_CHECK_ENABLE&&307===n?Fi({retryRequest:t,isRpc:"jsonRpc"===r}):Promise.resolve(e);var n})),window.ENVS.USE_AUTH_V3_HEADER&&t.addRequestInterceptor((e=>{const t=localStorage.getItem(He);return null!=e&&e.endpoint&&t&&xi(e)&&(e.headers=Object.assign({},e.headers,{AuthorizeV3:t})),e}));const r=new Set;t.addResponseInterceptor((async t=>{if(!localStorage.getItem(He)||t.url.endsWith(window.__ENDPOINTS__.VALIDATE_TOKEN)||r.has(t.url)||401!==t.status&&403!==t.status)return t;try{await Fn()?r.add(t.url):await Hn()}catch(n){localStorage.removeItem(He),e.dispatch(pe())}return t})),(new h.MiddlewaresController).setMiddleware({middleware:Gi,name:"@root/loginMiddleware"}),(new h.MiddlewaresController).setMiddleware({middleware:ji,name:"@root/loginMiddlewareSeparateDomain"}),Zt().ready.then((()=>t.addRequestInterceptor((async e=>{if(null==e||!e.endpoint||!e.getSignMessage||!xi(e))return e;try{const t=await SodiumKeyPair.fromLocalStorage(hr);if(!t)return e;const r=await t.sign(e.getSignMessage);e.headers=Object.assign({},e.headers,{"X-Req-Sign":r})}catch(t){console.error("Request sign error:",t)}return e}))))};var Wi=r(49146);(()=>{const e=new URL(document.location.href);null!==e.searchParams.get(Xe)&&(e.searchParams.delete(Xe),history.pushState(null,document.title,e),Qe=!0)})(),(0,V.Zz)({environment:window.ENVS.RUNTIME_ENV||"prod",enabledVendors:{facct:!!window.ENVS.FINGERPRINT_FACCT_ENABLED}});const{ENVS:{SENTRY_DSN_CLIENT:Ki,DISABLED_SW:Hi=!1},ADDITIONAL_MENU_CONFIG:zi}=window;Ki&&(E.sentryLogger.init({dsn:Ki,release:"root-monorepo@v1.25.0"}),console.log("@sentry init done")),Hi?"serviceWorker"in navigator&&new wi.ZW("/sw.js").register().then((e=>{null==e||e.unregister()})).catch((e=>{console.error(e.message)})):(()=>{if("serviceWorker"in navigator){const e=new wi.ZW("/sw.js");e.addEventListener("controlling",(()=>{document.hasFocus()?window.location.reload():document.addEventListener("visibilitychange",(()=>{window.location.reload()}))})),e.register().catch((e=>{console.error(e.message)}))}})();const Ji=(0,a.configureRouter)({defaultRoute:"page-not-found",eventNameToCancelRequests:h.ABORT_REQUEST_EVENT_NAME,enablei18nMiddleware:!0,modifiedNavigation:!0,disabledActionHandler:!0,enableDeactivationMiddleware:!0}),Xi=(0,o.createAppStore)({router:Ji,getDefaultMiddlewareOptions:{serializableCheck:!1},rootReducers:{[d.reducerProductsName]:d.reducerProducts,[p.reducerUserName]:p.reducerUser,[W]:(e=Y,{type:t,payload:r})=>{switch(t){case z:return Object.assign({},e,{modules:r.modules});case J:return Object.assign({},e,{loading:!0});case X:return Object.assign({},e,{loading:!1});default:return e}},[ie]:(e=be,{type:t,payload:r})=>{switch(t){case se:return Object.assign({},e,{initLoading:!0});case ce:return Object.assign({},e,{initLoading:!1});case oe:return Object.assign({},e,{translateIsLoading:!0});case de:return Object.assign({},e,{loginLoading:!0});case"@app-state/SET_LOGIN_LOADING_STOP":return Object.assign({},e,{loginLoading:!1});case ae:return Object.assign({},e,{translateIsLoading:!1});case Ee:return Object.assign({},e,{coreRequestsError:!0});case Ae:return Object.assign({},e,{coreRequestsErrorCode:r});case fe:return Object.assign({},e,{coreRequestsErrorCode:""});case me:return Object.assign({},e,{coreRequestsError:!1});case Se:return Object.assign({},e,{healthCheckCoreRequestsInterval:e.healthCheckCoreRequestsInterval+1e4});case Re:return Object.assign({},e,{firstRouteTransitionFinished:!0});case Ce:return Object.assign({},e,{logoutLoading:!0});case Ne:return Object.assign({},e,{logoutLoading:!1});default:return e}},[l.I18NEXT_REDUCER_NAME]:l.i18nReducer,[b.PWAReducerName]:b.reducerPWA},rootSagas:{[d.fetchProductsSagaName]:(0,d.createFetchProductsWatcherSaga)({loadModuleFunction:$,additionalProductsData:zi}),[p.fetchUserInfoWatcherSagaName]:p.fetchUserInfoWatcherSaga,[p.fetchUserPermissionsWatcherSagaName]:p.fetchUserPermissionsWatcherSaga,[G.JP]:G.Bm,[ne]:function*({router:e,store:t}){for(;;)yield(0,te.qn)(K),yield(0,te.rM)(re,{router:e,store:t})},[yr]:function*(){for(;;)yield(0,te.qn)(ue),yield(0,te.rM)(_r)},[d.PREFETCH_ROUTE_SAGA_NAME]:(0,d.createPreFetchRouteWatcherSaga)($),[d.NAVIGATE_TO_PRODUCT_SAGA_NAME]:(0,d.createNavigateToProductWatcherSaga)({loadModuleFunction:$,notFoundRouteName:"page-not-found",navigationErrorLogger:(console.log("@navigation-loggers init"),({routeName:e,data:t,menuName:r,navigateUrl:n})=>{const i=(({menuName:e="",routeName:t="",navigateUrl:r=""})=>t?`${Ai}, routeName: ${t}`:r?`${Ai}, navigateUrl: ${r}`:e?`${Ai}, menuName: ${e}`:Ai)({menuName:r,navigateUrl:n,routeName:e});E.sentryLogger.sendEvent({message:i,level:"Error",tags:{"request custom exception":!0,origin:window.origin,routename:e,url:"undefined"},extra:{data:JSON.stringify({routeName:e,data:t,menuName:r,navigateUrl:n},null,2),origin:window.origin}})})}),[G.lh]:G.RM,[l.FETCH_LANGUAGES_WATCHER_SAGA_NAME]:l.fetchLanguagesWatcherSaga,[Ti]:function*(){for(;yield(0,te.qn)(pi);)yield(0,te.rM)(vi),yield(0,te.gw)(100)},[br]:function*({dispatch:e}){for(;yield(0,te.qn)(ye);){const t=yield(0,te.rM)(Nr,{dispatch:e});yield(0,te.qn)(ve),yield(0,te.al)(t)}}},eventNameToCancelRequests:h.ABORT_REQUEST_EVENT_NAME,reduxStoreName:"@suppliers-portal-store",extraMiddlewares:[(e=>t=>t=>r=>{try{if((e=>e.type===Wi.i0)(r)&&r.type===Wi.i0){const t=(0,D.userPermissionsSelector)(window.ENVS.MAIN_ABAC_SCOPE);O.analyticsEventEmitter.sendEvent({name:"Supplier_PopUp_Error_S",customEvent:!0,params:{urlNoError:window.location.origin+e.getState().path,error_type:r.payload.text,error_text:r.payload.title,isOwner:Number(null==t?void 0:t.isOwnerSupplier)}})}}catch(n){console.error("Error in createAnalyticsMiddleware",n)}return t(r)})(Ji)]});(e=>{console.log("@request-proxies init"),(new h.InterceptorsController).addRequestInterceptor((e=>(e.endpoint=(0,N.resolveUrl)(e.endpoint),e))),(new h.MiddlewaresController).setMiddleware({middleware:Ii,name:"@root/geoHostsMiddleware"}),(new h.ProxyController).setResponseTrackCallback({callback:e=>{e.error&&E.sentryLogger.sendEvent({message:`Request error ${e.endpoint}`,tags:{"request custom exception":!0,origin:window.origin,"request-url":e.endpoint,url:"undefined"},responseData:e,level:"Error",request:{url:e.endpoint,method:e.method,data:JSON.stringify(e.requestBody,null,2),cookies:{all:e.requestCookies},headers:e.requestHeaders}})},name:"@root/initRequestLoggers"}),Vi(e),(e=>{(new h.MiddlewaresController).setMiddleware({middleware:bi(e),name:"@root/abacFallbackMiddleware"})})(e)})(Xi),Ji.useMiddleware((e=>t=>async(r,n)=>{const{routes:i}=t.getDependencies(),o=(0,a.getActivatedRoutes)(r,n,i);await Promise.all(o.map((async t=>{var r;const n=null==t||null==(r=t.params)?void 0:r.endpointsConfig,i=t.name;if(!n)return;const{fromWindow:o,staticPath:a,customModulePath:s}=n;var c;if(o)try{var l;const t=(0,d.getProductsData)(e.getState()).find((0,d.findRouteFromList)({routeName:i})),r=(({modulePath:e,customModulePath:t})=>t?`${t}/runtime-config.js`:`${e}runtime-config.js`)({modulePath:a,customModulePath:s}),n=null==t||null==(l=t.config)?void 0:l.envs;if(window.cachedWindowEnvs.has(i)){const e=window.cachedWindowEnvs.get(i);if(e){new Function(e)()}return}const o=Boolean(n)&&"RUNTIME_ENVS"!==n?{data:n,error:!1,errorText:""}:(c=r,(new h.PureRestRequest).getRequest({parseType:"text",mode:"cors",endpoint:c,cache:"no-cache",isErrorTextStraightToOutput:!0,retry:2,retryTimeInterval:3e3})),{error:u=!1,errorText:p="",data:E}=await o;if(u)throw new Error(p);new Function(E)(),window.cachedWindowEnvs.set(i,E)}catch(u){console.error("load endpoints from window error",u)}})))})(Xi)),Ji.setDependencies({store:Xi,i18nextConfig:{getLocale:()=>c.default.language,i18next:c.default,i18nextRequest:({endpoint:e,version:t="",isFileRequest:r})=>(new h.PureRestRequest).getRequest({extraValidationCallback:()=>!0,endpoint:e,parseType:"json",customTimeout:3e4,responseSchema:T().object({translate:T().object().required()}).required(),isErrorTextStraightToOutput:!0,retry:2,queryParams:{version:t},notRetryWhenOffline:!0,pureJsonFileResponse:r}),actionToStartLoading:()=>({type:oe}),actionToStopLoading:()=>({type:ae}),createEndpoint:l.getI18nextRequestEndpoint,formatterResponseData:e=>e.translate},analyticsEventEmitter:O.analyticsEventEmitter}),Ji.usePlugin(d.fetchRoutePlugin),Ji.usePlugin((e=>{const{store:t}=null==e?void 0:e.getDependencies();return{onTransitionSuccess(e,r){var n;const i=r&&r.name?r.name.split(".")[0]:null,o=e&&e.name?e.name.split(".")[0]:null,a=r&&e&&r.name===e.name,s=(null==e||null==(n=e.meta)||null==(n=n.options)?void 0:n.replace)&&o===i;i&&o&&!s&&!a&&t.dispatch(Ei())}}})),Ji.usePlugin((e=>{const{store:t}=null==e?void 0:e.getDependencies();return{onTransitionSuccess(e,r){e&&!r&&t.dispatch({type:Re})}}})),Ji.usePlugin((()=>({onTransitionStart:(e,t)=>{var r,n,i,o;if(e&&t&&e.name===t.name||!t)return;const a=null!=(r=null==t||null==(n=t.name)||null==n.split||null==(n=n.split("."))?void 0:n[0])?r:null,s=null!=(i=null==e||null==(o=e.name)||null==o.split||null==(o=o.split("."))?void 0:o[0])?i:null;s!==a&&a&&s&&navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js").then((e=>e.update())).catch((e=>console.log("SWClientUpdatePlugin gets an error: ",e)))}}))),Ji.useMiddleware(a.actionHandler),(()=>{const e=Number(window.ENVS.WB_ANALYTICS_COUNTER_ID),t=window.ENVS.WB_ANALYTICS_COOKIE_DOMAIN;O.analyticsEventEmitter.setAdditionalParamsGetter(Ci);const r=`_wbauid=; path=/; domain=${window.location.hostname}; expires=Thu, 01 Jan 1970 00:00:00 GMT`;document.cookie=r,O.analyticsEventEmitter.init({counterId:e,cookieDomain:t,withRequestIdleCallback:!1})})(),(async()=>{x.performanceMonitor.init({}),x.performanceMonitor.addMeasurement({name:"Domain",measurementData:{duration:window.origin}});const e=await Wr().getFirstConsistentlyInteractive();e&&"PerformanceLongTaskTiming"in window&&(x.performanceMonitor.addMeasurement({name:"TimeToInteractive",measurementData:{duration:e}}),x.performanceMonitor.sendMeasurements()),await(async()=>{await(0,h.pruneRequestCaches)({}),await Hr()})()})(),(()=>{window.addEventListener("appinstalled",(()=>{O.analyticsEventEmitter.sendEvent({name:"Supplier_Basic_PWA_Install",customEvent:!0})}));fi()&&O.analyticsEventEmitter.sendEvent({name:"Supplier_Basic_PWA_Initiation",customEvent:!0})})(),(({dispatch:e})=>{fi()||(U.isIOS&&U.isSafari?e((0,b.setPwaPromptIosShownAction)(!0)):(U.isChrome||U.isYandex&&U.isDesktop||U.isEdge&&U.isDesktop)&&(window.addEventListener("beforeinstallprompt",(t=>{t.preventDefault(),e((0,b.setPwaPromptAndroidEventAction)(t))})),window.addEventListener("appinstalled",(()=>{e((0,b.setPwaPromptAndroidEventAction)(null))}))))})(Xi);const Yi=document.getElementById("root"),Qi=(0,s.s)(Yi);(async({store:{dispatch:e},store:t,router:r})=>{const n=(0,l.getLocale)({isFromCookie:!0,supportedLocales:window.LANGUAGES_FALLBACK,localesMap:qe});let i,o;try{var a,s,u,E;e({type:se}),await(async()=>{if(!window.ENVS.ENABLE_CDN_V3)return;const{data:e,error:t}=await Yn({browserCacheParams:Qn({strategy:"StaleWhileRevalidate",cacheKey:"get-cdn-config-request",onUpdateCache:({data:e})=>{(0,N.setConfig)(e)},onRequestError:()=>{O.analyticsEventEmitter.sendEvent({name:Zn,customEvent:!0,params:{error:t,type:"get-cdn-config"}})}})});(0,N.setConfig)(e),window.addEventListener("error",(e=>{if(e.target instanceof HTMLImageElement){const t=e.target,r=t.src,n=(0,N.findUrlWithFallback)(r);if(O.analyticsEventEmitter.sendEvent({name:Zn,customEvent:!0,params:{recommendedUrl:r,originalUrl:n}}),n===r)return;n&&(t.src=n)}}),!0)})();try{await Hn()}catch(w){if(console.error("error in authViaV3: ",w),window.ENVS.DISABLE_PASSPORT_FALLBACK)throw w}(e=>{(0,P.setFetchProductsListener)((t=>{const{id:r}=(0,p.getUserInfo)(e.getState()),n=(0,p.getUserPermissions)(e.getState(),En),i=Tr({getCookie:vr}).key,o=wr({cacheKey:i,userId:r,menuFromFileRequest:!("menuTakenFromFile"in n)||n.menuTakenFromFile,defaultShown:!("activeSupplier"in n)||n.activeSupplier}),a=null!=n&&n.menuTakenFromFile?Object.assign({},t,{configs:o,permissions:n}):Object.assign({},t,{configs:o});e.dispatch((0,d.fetchMenuActionSaga)(a))})),(0,D.setFetchUserDataListener)((()=>{const{id:t}=(0,p.getUserInfo)(e.getState()),r=t?cn({userId:t}):null;e.dispatch((0,p.fetchUserInfoAction)({browserCacheParams:r}))})),(0,D.setFetchPermissionsListener)((t=>{var r,n;const{id:i}=(0,p.getUserInfo)(e.getState()),o=(0,p.getUserAllPermissions)(e.getState()),a=null==o||null==(r=o[Ar])?void 0:r[fr],s=null==(n=ln({getCookie:vr}))?void 0:n.key,{browserCacheParams:c,featuresFilterList:l,key:d}=sn({supplierId:s,userId:i,featuresFilterList:pn}),u=Object.assign({},t,{scope:window.ENVS.MAIN_ABAC_SCOPE,browserCacheParams:c,featuresFilterList:l,isNgABACEnabled:a}),E={featuresList:Cr(d?`${d}`:""),browserCacheParams:d&&i?an({cacheKey:`${je}-${d}-${i}`}):null,isNgABACEnabled:a};un(e),e.dispatch((0,on.$C)([(0,p.fetchUserPermissionsDataAction)(E),(0,p.fetchUserPermissionsAction)(d?Object.assign({},u,{key:d}):u)]))})),(0,D.setRefreshPermissionsListener)((t=>{const r=(0,p.getUserAllPermissions)(e.getState())[Ar][fr];e.dispatch((0,p.refreshUserFeaturesActionSaga)(Object.assign({},t,{isNgABACEnabled:r})))})),(0,P.setNavigateProductListener)((t=>{e.dispatch((0,d.navigateToProductActionSaga)(t))})),(0,P.setPrefetchProductListener)((t=>{e.dispatch((0,d.preloadRouteAction)(t))}))})(t),(0,l.setLocale)({locale:n,isFromCookie:!0}),(0,l.setHeadLang)(n),(0,l.setHtmlDir)(n),(0,l.setWildcardLocaleCookie)({locale:n,domain:yi}),await(0,l.geti18Next)({appNamespace:Ge,locale:n,debug:!1,fallbackLng:Me}),await(async e=>{if(Boolean(c.default.getResourceBundle(e,$e)))return;const t=Object.entries(Dn).map((async([e,t])=>{try{const r=await fetch(t).then((e=>e.json()));c.default.addResourceBundle(e,$e,r)}catch(r){console.error(`Failed to load translations for locale: ${e} in APP_NAMESPACE`,r)}})),r=Object.entries(bn).map((async([e,t])=>{try{const r=await fetch(t).then((e=>e.json()));c.default.addResourceBundle(e,kr,r)}catch(r){console.error(`Failed to load translations for locale: ${e} in errorPageNamespace`,r)}}));await Promise.all([...t,...r])})(n),hi&&e((0,l.setLanguagesListAction)(hi));const v=localStorage.getItem(He)||"",T=lr(v);if(T)await li({store:t,router:r}),i=null==T?void 0:T.user,o=null==T?void 0:T.session_id,LocalStorageWorker.setItem(`${Ge}.id`,i);else{var m,g,_;const[e]=await Promise.all([hn({}),li({store:t,router:r})]);await(async({response:e,isNotProductionOrigin:t})=>{const{error:r,errorText:n,code:i,headers:o}=e;if(!r)return LocalStorageWorker.setItem(`${Ge}.id`,e.data.userID),!0;if(i===h.OFFLINE_STATUS_CODE||i===xn.REQUEST_ERROR_STATUS_CODE&&!Object.keys(o).length)return!0;if(t)throw Error(n);return await ci({}),!0})({response:e,isNotProductionOrigin:_i}),i=(null==(m=e.data)?void 0:m.userID)||Number(null!=(g=LocalStorageWorker.getItem(`${Ge}.id`))?g:0),o=(null==(_=e.data)?void 0:_.sessionID)||""}const A=(null==t||null==(a=t.dependencies)?void 0:a.externalPackages)||{};window.LOAD_MODULE=e=>$(Object.assign({},e,{externalPackages:A})),(0,V.r1)({sessionId:o,userId:i,locale:n}),window.addEventListener("@data-subscriber/selected-supplier",(()=>{const e=(0,ur.selectedSupplierIdSelector)();(0,V.Hc)(e)})),LocalStorageWorker.setItem(Je,String(Date.now()));const f=(0,p.getFormattedFilteredFeatures)(mi),R=null==(s=ln({getCookie:vr}))?void 0:s.key;let C=!1;const I={supplierId:R,userId:i,onUpdateCache:e=>ui({supplierId:R,store:t,responseData:null==e?void 0:e.data,withPermissionsMerge:!0})},[L,x,k,U]=await Promise.all([(0,p.loadUserPermissionsRequest)(Object.assign({},sn({supplierId:R,strategy:"StaleWhileRevalidate",userId:i,featuresFilterList:f}))),Xn(I),window.ENVS.ENABLE_NG_ABAC?(0,p.loadUserPermissionsRequest)(Object.assign({},sn({supplierId:R,strategy:"StaleWhileRevalidate",userId:i,featuresFilterList:f,isNgABACEnabled:!0}),{isNgABACEnabled:!0})):null,window.ENVS.ENABLE_NG_ABAC?Xn(Object.assign({},I,{isNgABACEnabled:!0})):null]),F=Cr(R);if(null!=x&&x.length&&null!=U&&U.length){var y,S;const e=(0,p.getFormattedABACRefreshResponse)({fullResponse:x,initialValues:F}),t=(0,p.getFormattedABACRefreshResponse)({fullResponse:U,initialValues:F});C=(null==e||null==(y=e[Ar])?void 0:y[fr])&&(null==t||null==(S=t[Ar])?void 0:S[fr])}const{data:M}=(C?k:L)||{data:{},error:!0},q={features:{permitted:{[fr]:C}}};ei({dispatch:t.dispatch,permissions:q,scope:Ar}),ei({dispatch:t.dispatch,permissions:M,scope:gi}),ui({supplierId:R,store:t,responseData:C?U:x}),di({userInfo:{id:i},dispatch:t.dispatch}),e(H()),t.dispatch((0,p.fetchUserInfoAction)({browserCacheParams:cn({userId:i,onUpdateCache:({data:e})=>{di({userInfo:e.user,dispatch:t.dispatch})},strategy:"StaleWhileRevalidate"})})),e((0,b.fetchManifestActionSaga)({request:gn}));const B=null!=(u=null==M||null==(E=M.features)?void 0:E.permitted)?u:{};B.isWebVitalsEnabled&&((0,Gr.mw)((e=>O.analyticsEventEmitter.sendEvent(new ClsAnalyticsEvent(e))),{reportAllChanges:window.ENVS.CLS_REPORT_ALL_CHANGES}),(0,Gr.a4)((e=>O.analyticsEventEmitter.sendEvent(new FcpAnalyticsEvent(e))),{reportAllChanges:window.ENVS.FCP_REPORT_ALL_CHANGES}),(0,Gr.Yn)((e=>O.analyticsEventEmitter.sendEvent(new InpAnalyticsEvent(e))),{reportAllChanges:window.ENVS.INP_REPORT_ALL_CHANGES}),(0,Gr.NO)((e=>O.analyticsEventEmitter.sendEvent(new LcpAnalyticsEvent(e))),{reportAllChanges:window.ENVS.LCP_REPORT_ALL_CHANGES}),(0,Gr.mr)((e=>O.analyticsEventEmitter.sendEvent(new TtfbAnalyticsEvent(e))),{reportAllChanges:window.ENVS.TTFB_REPORT_ALL_CHANGES}));const j=Tr({getCookie:vr}).key,G=wr({cacheKey:j,strategy:"StaleWhileRevalidate",userId:i,menuFromFileRequest:!("menuTakenFromFile"in B)||B.menuTakenFromFile,defaultShown:!("activeSupplier"in B)||B.activeSupplier});e((0,d.fetchMenuActionSaga)({permissions:B,excludeEndpoinds:Si,callbackFinallyLoad:async({loadProductsStopAction:t})=>{e((0,on.$C)([t(),le()]))},callbackOnError:({loadProductsStopAction:t,errorData:r})=>{const n=r.headers["x-request-id"]||"";var i;e((0,on.$C)([t(),he(),(i=n,{type:Ae,payload:i}),le()]))},configs:G})),(({dispatch:e})=>{document.addEventListener("visibilitychange",(()=>{"hidden"!==document.visibilityState&&e(Ei())}))})(t)}catch(v){if(console.error("error when initialize ROOT: ",v.message),"I18N_ERROR_TEXT"===v.message)return;if(v.message===zn)return void e((0,on.$C)([H(),le(),(0,p.setUserPermissionsAction)({permissions:{[gi]:{}}}),he()]));et(),Ze(n)}})({store:Xi,router:Ji}).then((()=>Qi.render((0,Pr.jsx)(u.RouterProvider,{router:Ji,children:(0,Pr.jsx)(nn,{store:Xi})}))))},73637:(e,t,r)=>{r.p=window.PUBLIC_STATIC_HOST+"/vol20/root-monorepo/latest/"},22901:()=>{},68236:()=>{},76620:()=>{},53260:()=>{}},e=>{e.O(0,[736],(()=>{return t=77552,e(e.s=t);var t}));e.O()}]);